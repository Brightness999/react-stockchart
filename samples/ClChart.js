!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define("ClChart",[],i):"object"==typeof exports?exports.ClChart=i():t.ClChart=i()}(window,function(){return function(t){var i={};function e(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:s})},e.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=4)}([function(t,i,e){"use strict";function s(t,i){return("000000000"+t).slice(-1*(i=i>9?9:i))}function n(t){let i,e;return void 0===t?i=new Date:(e="string"==typeof t?parseInt(t):t,i=isNaN(e)?new Date:new Date(1e3*e)),i}function o(t){const i=n(t);return 1e4*i.getFullYear()+100*(i.getMonth()+1)+i.getDate()}function h(t){const i=n(t);return 100*i.getHours()+i.getMinutes()}function a(t){return new Date(Math.floor(t/1e4),Math.floor(t%1e4/100)-1,t%100).getDay()}function l(t){return new Date(Math.floor(t/1e4),Math.floor(t%1e4/100)-1,t%100).getMonth()+1}function c(t){return new Date(Math.floor(t/1e4),Math.floor(t%1e4/100)-1,t%100)/1e3}function r(t,i){return Math.floor((c(i)-c(t))/86400)}function f(t,i,e){const o=n(t);switch(i){case"minute":return void 0===e?o.getHours()+":"+s(o.getMinutes(),2):h(t)===h(e)?":"+s(o.getSeconds(),2):o.getHours()+":"+s(o.getMinutes(),2);case"datetime":return 1e4*o.getFullYear()+100*(o.getMonth()+1)+o.getDate()+"-"+o.getHours()+":"+s(o.getMinutes(),2);default:return""}}function d(t,i){return 60*(Math.floor(i/100)-Math.floor(t/100))+i%100-t%100}function u(t,i){const e=60*Math.floor(t/100)+t%100+i;return 100*Math.floor(e/60)+e%60}function m(t){let i;if(Array.isArray(t)){i=[];const e=t.length;for(let s=0;s<e;s++)i[s]=m(t[s])}else i=t;return i}function x(t){let i;if(t instanceof Object)if(Array.isArray(t))i=m(t);else{i={};for(const e in t)i[e]=x(t[e])}else i=t;return i}function g(t,i){let e;if(i instanceof Object)if(Array.isArray(i)){e=[];for(const s in i)e[s]=t&&t[s]?g(t[s],i[s]):m(i[s])}else{e={};for(const s in i)e[s]=t&&t[s]?g(t[s],i[s]):x(i[s])}else e=t||i;return e}function v(t){return!(void 0!==t&&Array.isArray(t)&&t.length>0)}function p(t,i){return void 0===t?{left:0,top:0,width:0,height:0}:void 0===i?t:{left:t.left+i.left,top:t.top+i.top,width:t.width-(i.left+i.right),height:t.height-(i.top+i.bottom)}}function y(t,i){return void 0!==t&&void 0!==i&&i.x>=t.left&&i.y>=t.top&&i.x<t.left+t.width&&i.y<t.top+t.height}function b(t,i){return void 0!==t&&void 0!==i&&i>=t.left&&i<t.left+t.width}function I(t,i){return void 0!==t&&void 0!==i&&i>=t.top&&i<t.top+t.height}function M(t,i){return!(i.indexOf(t)<0)}function w(t,i){if(void 0===t||isNaN(t))return"--";"string"==typeof t&&(t=parseFloat(t)),void 0===i&&(i=1);let e=t/i;return e=t>1e11?(t/1e8).toFixed(0)+"亿":t>1e10?(t/1e8).toFixed(1)+"亿":t>1e9?(t/1e8).toFixed(2)+"亿":t>1e8?(t/1e8).toFixed(3)+"亿":t>1e7?(t/1e4).toFixed(0)+"万":t>1e6?(t/1e4).toFixed(1)+"万":t>-1e-9&&t<1e-9?"--":t.toFixed(0),String(e)}function D(t,i,e,s){if(void 0===t||isNaN(t))return"--";let n=t;return(void 0===i||i<0||i>10)&&(i=0),t>-1e-9&&t<1e-9&&!s?"--":(n=n.toFixed(i),void 0===e||e<4?n:n.substr(0,e))}function k(t,i,e){let n=i;switch(t){case"M5":case"M15":case"M30":case"M60":n=f(i,"datetime");break;case"MIN":n=void 0===e?f(i,"minute"):function(t){return s(Math.floor(t/100),2).toString()+":"+s(t%100,2).toString()}(e);break;case"DAY5":n=f(i,"minute")}return n}function O(t,i,e,s){let n;return"rate"===i?n=function(t,i){if(void 0===t||isNaN(t)||void 0===i)return"--";"string"==typeof t&&(t=parseFloat(t));let e=Math.abs((t-i)/i*100);return e.toFixed(2)+"%"}(t,s):"price"===i?(void 0===e&&(e=2),n=D(t,e,7)):n=w(t,100),n}e.d(i,"h",function(){return o}),e.d(i,"l",function(){return h}),e.d(i,"k",function(){return a}),e.d(i,"j",function(){return l}),e.d(i,"i",function(){return r}),e.d(i,"g",function(){return f}),e.d(i,"m",function(){return d}),e.d(i,"n",function(){return u}),e.d(i,"a",function(){return m}),e.d(i,"b",function(){return x}),e.d(i,"u",function(){return g}),e.d(i,"s",function(){return v}),e.d(i,"t",function(){return p}),e.d(i,"r",function(){return y}),e.d(i,"p",function(){return b}),e.d(i,"q",function(){return I}),e.d(i,"o",function(){return M}),e.d(i,"f",function(){return w}),e.d(i,"d",function(){return D}),e.d(i,"e",function(){return k}),e.d(i,"c",function(){return O})},function(t,i,e){"use strict";e.d(i,"d",function(){return o}),e.d(i,"m",function(){return c}),e.d(i,"n",function(){return r}),e.d(i,"f",function(){return f}),e.d(i,"e",function(){return d}),e.d(i,"j",function(){return u}),e.d(i,"c",function(){return m}),e.d(i,"b",function(){return x}),e.d(i,"a",function(){return g}),e.d(i,"o",function(){return v}),e.d(i,"l",function(){return p}),e.d(i,"k",function(){return y}),e.d(i,"i",function(){return b}),e.d(i,"h",function(){return I}),e.d(i,"g",function(){return M});var s=e(2),n=e(0);function o({fields:t,value:i,coinunit:e},s,n=0){let h=0;try{let a=i;switch(Array.isArray(i[0])&&(a=i[n]),s){case"idx":h=void 0===t.idx?n:a[t.idx];break;case"coinunit":h=Math.pow(10,o({fields:t,value:i},"decimal",0));break;case"before":case"open":case"high":case"low":case"close":case"stophigh":case"stoplow":case"buy1":case"buy2":case"buy3":case"buy4":case"buy5":case"sell1":case"sell2":case"sell3":case"sell4":case"sell5":void 0===e&&(e=100),h=a[t[s]]/e;break;case"flow":case"total":h=100*a[t[s]];break;case"decvol":h=0===n?a[t.vol]:a[t.vol]-o({fields:t,value:i},"vol",n-1);break;case"decmoney":h=0===n?a[t.money]:a[t.money]-o({fields:t,value:i},"money",n-1);break;default:a[t[s]]&&(h=a[t[s]])}}catch(t){h=0}return h}function h(t,i,e,s){return void 0===i&&(i=100),t="forword"===s?1e3*(t*(1e3/i)-e.pg-e.px)/e.gs:t*(1e3/i)*e.gs/1e3+e.pg+e.px,Math.floor(t/(1e3/i)+.5)}function a(t,i,e,n,o,a){const l=function(t){let i=1e3,e=0,n=0;return t[s.FIELD_RIGHT.accrual]&&(n=t[s.FIELD_RIGHT.accrual]/10),(t[s.FIELD_RIGHT.sendstock]>0||t[s.FIELD_RIGHT.allotstock]>0)&&(i=1e3+t[s.FIELD_RIGHT.sendstock]/10+t[s.FIELD_RIGHT.allotstock]/10,e=-t[s.FIELD_RIGHT.allotprice]*t[s.FIELD_RIGHT.allotstock]/1e4),{gs:i,pg:e,px:n}}(e);if("forword"===n)for(let e=o;e<a;e++)t[e][s.FIELD_DAY.open]=h(t[e][s.FIELD_DAY.open],i,l,n),t[e][s.FIELD_DAY.high]=h(t[e][s.FIELD_DAY.high],i,l,n),t[e][s.FIELD_DAY.low]=h(t[e][s.FIELD_DAY.low],i,l,n),t[e][s.FIELD_DAY.close]=h(t[e][s.FIELD_DAY.close],i,l,n),t[e][s.FIELD_DAY.vol]=t[e][s.FIELD_DAY.vol]*l.gs/1e3}function l(t,i,e){return e>t&&e<=i}function c(t,i,e,n,o,h){if(e.length<1||t.length<1)return t;if(void 0===n&&(n="forword"),(void 0===o||o<0||o>t.length-1)&&(o=0),(void 0===h||h<0)&&(h=t.length-1),"forword"===n)for(let c=o;c<=h;c++)for(let h=0;h<e.length;h++)if(!(c<1)&&l(t[c-1][s.FIELD_DAY.time],t[c][s.FIELD_DAY.time],e[h][s.FIELD_RIGHT.time])){a(t,i,e[h],n,o,c);break}return t}function r(t,i,e,o,h,c){if(e.length<1||t.length<1)return t;if(void 0===o&&(o="forword"),(void 0===h||h<0||h>t.length-1)&&(h=0),(void 0===c||c<0)&&(c=t.length-1),"forword"===o)for(let r=h;r<=c;r++)for(let c=0;c<e.length;c++)if(!(r<1)&&l(Object(n.h)(t[r-1][s.FIELD_DAY.time]),Object(n.h)(t[r][s.FIELD_DAY.time]),e[c][s.FIELD_RIGHT.time])){a(t,i,e[c],o,h,r);break}return t}function f(t,i){if(t.value.length<1)return{status:"new",index:-1};const e=t.value[t.value.length-1][t.fields.time];return e===i?{status:"old",index:t.value.length-1}:e>i?{status:"error",index:t.value.length-1}:{status:"new",index:t.value.length-1}}function d(t,i){return void 0===t||void 0===t.value||t.value.length<1?{finded:!1,index:-1}:i===t.value[t.value.length-1][t.fields.time]?{finded:!0,index:t.value.length-1}:{finded:!1,index:-1}}function u(t){return void 0===t||Object(n.s)(t.value)?0:t.value.length}function m(t,i){return!(Array.isArray(t)&&t[i.open]>0&&t[i.high]>0&&t[i.low]>0&&t[i.close]>0&&t[i.vol]>0&&t[i.money]>0)}function x(t){const i=[];if(!Array.isArray(t))return i;for(let e=0;e<t.length;e++)m(t[e],s.FIELD_DAY)||i.push(t[e]);return i}function g(t,i,e,o){const h=[];if(t.length<1)return h;let a,l=5;!Object(n.h)(t[t.length-1][s.FIELD_DAY5.time])===e&&(l=4);let c=0,r=0;for(a=t.length-1;a>=0;a--){if(r!==Object(n.h)(t[a][s.FIELD_DAY5.time])&&(r=Object(n.h)(t[a][s.FIELD_DAY5.time]),++c>l)){a++;break}h.splice(0,0,[t[a][s.FIELD_DAY5.time],t[a][s.FIELD_DAY5.close],t[a][s.FIELD_DAY5.vol]])}c=0,r=0;let f=0,d=0;const u=b(o);for(a=0;a<h.length;a++){r!==Object(n.h)(h[a][s.FIELD_DAY5.time])&&(r=Object(n.h)(h[a][s.FIELD_DAY5.time]),c++,f=0,d=0),f+=h[a][s.FIELD_DAY5.vol],d+=h[a][s.FIELD_DAY5.close]*h[a][s.FIELD_DAY5.vol]/i;let t=I(h[a][s.FIELD_DAY5.time],o);t+=(c-1)*u,h[a][s.FIELD_DAY5.idx]=t,h[a][s.FIELD_DAY5.allvol]=f,h[a][s.FIELD_DAY5.allmoney]=d}return h}function v(t,i){const e=o({fields:t,value:i},"coinunit");return{stktype:o({fields:t,value:i},"type"),volunit:o({fields:t,value:i},"volunit"),coinunit:e,decimal:o({fields:t,value:i},"decimal"),before:o({fields:t,value:i,coinunit:e},"before"),stophigh:o({fields:t,value:i,coinunit:e},"stophigh"),stoplow:o({fields:t,value:i,coinunit:e},"stoplow")}}function p(t){const i=[],e=[],o=s.FIELD_DAY;let h=!0;for(let s=0;s<t.length;s++){h?(e[o.open]=t[s][o.open],e[o.high]=t[s][o.high],e[o.low]=t[s][o.low],h=!1):(e[o.high]=e[o.high]>t[s][o.high]?e[o.high]:t[s][o.high],e[o.low]=e[o.low]<t[s][o.low]||0===t[s][o.low]?e[o.low]:t[s][o.low]),e[o.close]=t[s][o.close],e[o.vol]=t[s][o.vol],e[o.money]=t[s][o.money];const a=Object(n.k)(t[s][o.time]);console.log("week",s,a,t[s][o.time]),(s>=t.length-1||5===a||Object(n.i)(t[s][o.time],t[s+1][o.time])+a>7)&&(e[o.time]=t[s][o.time],i.push(Object(n.a)(e)),h=!0)}return h||(e[o.time]=t[t.length-1][o.time],i.push(Object(n.a)(e))),i}function y(t){let i;const e=[],o=[],h=s.FIELD_DAY;let a=!0;for(let s=0;s<t.length;s++)a?(o[h.open]=t[s][h.open],o[h.high]=t[s][h.high],o[h.low]=t[s][h.low],i=Object(n.j)(t[s][h.time]),a=!1):(o[h.high]=o[h.high]>t[s][h.high]?o[h.high]:t[s][h.high],o[h.low]=o[h.low]<t[s][h.low]||0===t[s][h.low]?o[h.low]:t[s][h.low]),o[h.close]=t[s][h.close],o[h.vol]=t[s][h.vol],o[h.money]=t[s][h.money],(s>=t.length-1||Object(n.j)(t[s+1][h.time])!==i)&&(o[h.time]=t[s][h.time],e.push(Object(n.a)(o)),a=!0);return a||(o[h.time]=t[t.length-1][h.time],e.push(Object(n.a)(o))),e}function b(t){let i=0;for(let e=0;e<t.length;e++)i+=Object(n.m)(t[e].begin,t[e].end);return i}function I(t,i){const e=Object(n.l)(t);let s=0,o=-1;for(let t=0;t<i.length;t++){if(e>i[t].begin&&e<i[t].end){o=s+Object(n.m)(i[t].begin,e);break}if(e<=i[t].begin&&0===t)return 0;if(e<=i[t].begin&&e>Object(n.n)(i[t].begin,-5))return s;if(s+=Object(n.m)(i[t].begin,i[t].end),e>=i[t].end&&t===i.length-1)return s-1;if(e>=i[t].end&&e<Object(n.n)(i[t].end,5))return s-1}return o}function M(t,i,e){let s=t,o=0,h=0;for(let t=0;t<i.length;t++){if(s<(h=Object(n.m)(i[t].begin,i[t].end))){o=Object(n.n)(i[t].begin,s+1);const h=new Date(Math.floor(e/1e4),Math.floor(e%1e4/100)-1,e%100,Math.floor(o/100),o%100,0);return Math.floor(h/1e3)}s-=h}return 0}},function(t,i,e){"use strict";e.r(i),e.d(i,"STOCK_TYPE_INDEX",function(){return s}),e.d(i,"STOCK_TYPE_A",function(){return n}),e.d(i,"STOCK_TYPE_B",function(){return o}),e.d(i,"STOCK_TYPE_OTHER",function(){return h}),e.d(i,"STOCK_TRADETIME",function(){return a}),e.d(i,"FIELD_DAY",function(){return l}),e.d(i,"FIELD_MIN",function(){return c}),e.d(i,"FIELD_TICK",function(){return r}),e.d(i,"FIELD_DAY5",function(){return f}),e.d(i,"FIELD_LINE",function(){return d}),e.d(i,"FIELD_ILINE",function(){return u}),e.d(i,"FIELD_NOW",function(){return m}),e.d(i,"FIELD_ENOW",function(){return x}),e.d(i,"FIELD_NOW_IDX",function(){return g}),e.d(i,"FIELD_CODE",function(){return v}),e.d(i,"FIELD_INFO",function(){return p}),e.d(i,"FIELD_RIGHT",function(){return y}),e.d(i,"FIELD_FINANCE",function(){return b}),e.d(i,"FIELD_SEER",function(){return I}),e.d(i,"FIELD_TRADE",function(){return M});const s=0,n=1,o=4,h=5,a=[{begin:930,end:1130},{begin:1300,end:1500}],l={time:0,open:1,high:2,low:3,close:4,vol:5,money:6},c={idx:0,open:1,high:2,low:3,close:4,vol:5,money:6,allvol:5,allmoney:6},r={time:0,close:1,vol:2},f={time:0,close:1,vol:2,idx:3,allvol:4,allmoney:5},d={time:0,value:1},u={idx:0,value:1},m={time:0,open:1,high:2,low:3,close:4,vol:5,money:6,buy1:7,buyvol1:8,sell1:9,sellvol1:10,buy2:11,buyvol2:12,sell2:13,sellvol2:14,buy3:15,buyvol3:16,sell3:17,sellvol3:18,buy4:19,buyvol4:20,sell4:21,sellvol4:22,buy5:23,buyvol5:24,sell5:25,sellvol5:26},x={time:0,open:1,high:2,low:3,close:4,vol:5,money:6,buy1:7,buyvol1:8,sell1:9,sellvol1:10},g={time:0,open:1,high:2,low:3,close:4,vol:5,money:6,ups:7,upvol:8,downs:9,downvol:10,mids:11,midvol:12},v={index:0,code:1,name:2,spell:3,type:4,decimal:5,volunit:6,before:7,stophigh:8,stoplow:9},p={name:0,type:1,decimal:2,volunit:3,before:4,stophigh:5,stoplow:6},y={time:0,sendstock:1,allotstock:2,allotprice:3,accrual:4},b={code:0,time:1,flow:2,total:3,earnings:4},I={code:0,start:1,period:2,buy:3,target:4,stoploss:5,status:6,stopdate:7,surplus:10,uid:11,focused:12},M={time:0,code:1,type:2,price:3,vol:4,money:5,info:6}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return ClFormula});var _data_cl_data_tools__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);function ClFormula(){this.source={data:{},minIndex:0,maxIndex:0,nowIndex:0},this.getValue=function(t,i){if(void 0===t)return 0;if(void 0===this.source.data||void 0===this.source.data.value)return 0;void 0===this.source.nowIndex&&(this.source.nowIndex=this.source.minIndex);const e=this.source.nowIndex-i;return Object(_data_cl_data_tools__WEBPACK_IMPORTED_MODULE_0__.d)(this.source.data,t,e)},this.runSingleStock=function(source,formula){const singleValue=[];this.source=source;const command=`\n    for (this.source.nowIndex = this.source.minIndex;this.source.nowIndex <= this.source.maxIndex;this.source.nowIndex++) {\n          const ${formula}\n          singleValue.push([this.getValue('idx', 0), out]);\n    }`;return eval(command),singleValue},this.MA=function(t,i){let e=0,s=0;for(let n=0;n<i;n++){const i=this.getValue(t,n);0!==i&&(e++,s+=i)}return 0===e?0:s/e},this.AVGPRC=function(){return this.getValue("allmoney",0)/this.getValue("allvol",0)}}},function(t,i,e){"use strict";e.r(i);var s={};e.d(s,"CHART_LAYOUT",function(){return F}),e.d(s,"CHART_BUTTONS",function(){return P}),e.d(s,"CHART_ORDER",function(){return N}),e.d(s,"CHART_KBAR",function(){return R}),e.d(s,"CHART_VBAR",function(){return H}),e.d(s,"CHART_NOW",function(){return S}),e.d(s,"CHART_NOWVOL",function(){return z}),e.d(s,"CHART_DAY5",function(){return K}),e.d(s,"CHART_DAY5VOL",function(){return W}),e.d(s,"CHART_NORMAL",function(){return G});var n=e(0);function o(t,i){t.lineWidth=i}function h(t,i,e,s){t.moveTo(i,e),t.lineTo(i,s)}function a(t,i,e,s){t.moveTo(i,s),t.lineTo(e,s)}function l(t,i,e){t.moveTo(i,e)}function c(t,i,e){t.lineTo(i,e)}function r(t,i,e,s,n){t.strokeRect(i,e,s,n)}function f(t,i,e,s,n,o){t.fillStyle=o||t.fillStyle,t.fillRect(i,e,s,n)}function d(t,i){t.beginPath(),t.strokeStyle=i||t.strokeStyle}function u(t){t.stroke()}function m(t,i,e){t.font=" "+e+"px "+i}function x(t,i,e,s,n,o,h,a){m(t,n,o),t.fillStyle=h||t.fillStyle,t.textBaseline=a&&a.y||"top",t.textAlign=a&&a.x||"start",t.fillText(s,i,e)}function g(t,i,e,s){return m(t,e,s),t.measureText(i).width}function v(t,i,e,s,n){const o=n.spaceX||2,h=n.spaceY||2,a=function(t,i,e){const s=e.spaceX||2,n=e.spaceY||2;return{width:g(t,i,e.font,e.pixel)+2*s,height:e.pixel+2*n}}(t,s,n);let l,c;c=e,l=i,"middle"===n.y&&(c=e-Math.floor(a.height/2)),"end"===n.x&&(l=i-a.width),"center"===n.x&&(l=i-Math.floor(a.width/2)),f(t,l,c,a.width,a.height,n.bakclr),d(t,n.clr),r(t,l,c,a.width,a.height),l=i,c=e,"start"===n.x&&(l=i+o),"end"===n.x&&(l=i-o),"top"===n.y&&(c=e-h),x(t,l,c,s,n.font,n.pixel,n.clr,{x:n.x,y:n.y}),u(t)}function p(t,i,e,s){t.moveTo(i+s,e),t.arc(i,e,s,0,2*Math.PI,!0)}function y(t,i,e,s,n){t.moveTo(i+s,e),t.arc(i,e,s,0,2*Math.PI,!0),t.fillStyle=n,t.fill()}function b(t,i,e,s,n,o){const h=t.strokeStyle;d(t,o),t.moveTo(i,e),t.lineTo(s,n),u(t),t.strokeStyle=h}function I(t,i,e){const s=i.rect.left+i.index*(i.unitX+i.spaceX),n=s+Math.floor(i.unitX/2),o=i.rect.top+Math.round((i.maxmin.max-e[1])*i.unitY),l=i.rect.top+i.rect.height-Math.round((e[2]-i.maxmin.min)*i.unitY);let c;const d=i.rect.top+Math.round((i.maxmin.max-e[0])*i.unitY);e[0]===e[3]?(c=0,a(t,s,s+i.unitX,d),e[1]>e[2]&&h(t,n,o,l)):(c=Math.round((e[0]-e[3])*i.unitY),h(t,n,o,d),i.filled?f(t,s,d,i.unitX,c,i.fillclr):r(t,s,d,i.unitX,c),h(t,n,d+c,l))}function M(t,i,e){const s=i.rect.left+i.index*(i.unitX+i.spaceX),n=i.rect.top+Math.round((i.maxmin.max-e)*i.unitY),o=i.rect.top+i.rect.height-n;i.filled?f(t,s,n,i.unitX,o,i.fillclr):r(t,s,n,i.unitX,o)}let w={runPlatform:"normal",axisPlatform:"phone",eventPlatform:"html5",scale:1,standard:"china",sysColor:"black"};const D={sys:"white",line:["#4048cc","#dd8d2d","#168ee0","#ad7eac","#ff8290","#ba1215"],back:"#fafafa",txt:"#2f2f2f",baktxt:"#2f2f2f",axis:"#7f7f7f",grid:"#cccccc",red:"#ff6a6c",green:"#32cb47",white:"#7e7e7e",vol:"#dd8d2d",button:"#888888",colume:"#41bfd0",box:"#ddf4df",code:"#3f3f3f"},k={sys:"black",line:["#efefef","#fdc104","#5bbccf","#ad7eac","#bf2f2f","#cfcfcf"],back:"#232323",txt:"#bfbfbf",baktxt:"#2f2f2f",axis:"#afafaf",grid:"#373737",red:"#ff6a6c",green:"#6ad36d",white:"#9f9f9f",vol:"#fdc104",button:"#9d9d9d",colume:"#41bfd0",box:"#373737",code:"#41bfd0"};function O(t,i){let e={};if(e="white"===t?Object(n.b)(D):Object(n.b)(k),"usa"===i){const t=e.red;e.red=e.green,e.green=t}return e}function C(t){if(void 0!==t){void 0!==t.canvas&&1!==t.scale&&(i=t.canvas,e=t.scale,console.log(i.clientWidth,i.width),i.width=i.clientWidth*e,i.height=i.clientHeight*e,i.width,i.height,w.canvas=t.canvas),w.context=t.context;for(const i in w)w[i]=t[i]||w[i];console.log(w)}var i,e;w.color=O(w.sysColor,w.standard)}function j(t,i){t.father=i,t.context=i.context,t.scale=w.scale,t.color=w.color,t.axisPlatform=w.axisPlatform,t.eventPlatform=w.eventPlatform}function X(t){const i=w.scale;t.margin.top*=i,t.margin.left*=i,t.margin.bottom*=i,t.margin.right*=i,t.offset.top*=i,t.offset.left*=i,t.offset.bottom*=i,t.offset.right*=i,t.title.pixel*=i,t.title.height*=i,t.title.spaceX*=i,t.title.height<t.title.pixel+2*i&&(t.title.height=t.title.pixel+2*i),t.axisX.pixel*=i,t.axisX.width*=i,t.axisX.height*=i,t.axisX.spaceX*=i,t.scroll.pixel*=i,t.scroll.size*=i,t.scroll.spaceX*=i,t.digit.pixel*=i,t.digit.height*=i,t.digit.spaceX*=i,t.digit.height<t.digit.pixel+2*i&&(t.digit.height=t.digit.pixel+2*i),t.symbol.pixel*=i,t.symbol.size*=i,t.symbol.spaceX*=i,t.symbol.spaceY*=i,t.symbol.size<t.symbol.pixel+2*i&&(t.symbol.size=t.symbol.pixel+2*i)}function L(t){"html5"===w.eventPlatform&&(w.canvas.style.cursor=t)}var Y=e(1);function E(t,i,e,s){if(void 0===e&&(e="time"),s&&"forword"===s){for(let s=t.value.length-1;s>=0;s--)if(!(Object(Y.d)(t,e,s)>i))return s}else for(let s=0;s<=t.value.length-1;s++)if(!(Object(Y.d)(t,e,s)<i))return s;return-1}function T(t,i){t.showMode="fixed",t.fixed={min:0,max:i.maxCount-1,left:0,right:0},t.minIndex=0,t.maxIndex=i.size-1,t.maxCount=i.maxCount>1?i.maxCount:2,t.unitX=w.scale,t.spaceX=i.width/t.maxCount-t.unitX}function _(t,i){j(this,t),this.rectMain=i,this.linkInfo=t.father.linkInfo,this.source=t.father,this.maxmin=t.maxmin,this.onPaint=function(t){let i,e;this.data=this.source.getData(t),void 0===this.info.labelX&&(this.info.labelX="idx"),void 0===this.info.labelY&&(this.info.labelY="value");let s,o=!1,h=0;d(this.context,this.info.color);for(let t=this.linkInfo.minIndex,a=0;t<=this.linkInfo.maxIndex;t++,a++)s=void 0===this.info.showSort?a:Object(Y.d)(this.data,this.info.showSort,a),i=this.rectMain.left+s*(this.linkInfo.unitX+this.linkInfo.spaceX),e=this.rectMain.top+Math.round((this.maxmin.max-Object(Y.d)(this.data,this.info.labelY,a))*this.maxmin.unitY),Math.floor(s/this.info.skips)>h&&(h=Math.floor(s/this.info.skips),o=!1),o?c(this.context,i,e):(o=Object(n.r)(this.rectMain,{x:i,y:e}))&&l(this.context,i,e);u(this.context)}}function A(t,i){j(this,t),this.rectMain=i,console.log("---1--",this.rectMain),this.linkInfo=t.father.linkInfo,this.source=t.father,this.maxmin=t.maxmin,this.onPaint=function(t){let i,e,s,n;this.data=this.source.getData(t),console.log(this.data,t,this.info,this.maxmin,this.rectMain),void 0===this.info.labelX&&(this.info.labelX="time"),void 0===this.info.labelY&&(this.info.labelY="vol"),d(this.context,this.color[this.info.color]);for(let t=this.linkInfo.minIndex,o=0;t<=this.linkInfo.maxIndex;t++,o++)n=void 0===this.info.showSort?o:Object(Y.d)(this.data,this.info.showSort,o),i=this.rectMain.left+Math.floor(n*(this.linkInfo.spaceX+this.linkInfo.unitX)),(s=Object(Y.d)(this.data,this.info.labelY,t))<0||((e=this.rectMain.top+Math.round((this.maxmin.max-s)*this.maxmin.unitY))<this.rectMain.top?(e=this.rectMain.top+1,b(this.context,i,this.rectMain.top+this.rectMain.height-1,i,e,this.color.white)):(l(this.context,i,this.rectMain.top+this.rectMain.height-1),c(this.context,i,e)));u(this.context)}}const F={margin:{left:0,top:0,right:0,bottom:0},offset:{left:2,top:2,right:2,bottom:0},title:{pixel:12,height:18,spaceX:10,font:"sans-serif"},axisX:{pixel:12,height:18,width:50,spaceX:2,font:"sans-serif"},scroll:{pixel:12,size:15,spaceX:10,font:"sans-serif"},digit:{pixel:12,height:16,spaceX:3,font:"Arial"},symbol:{pixel:10,size:16,spaceX:3,spaceY:2,font:"Arial"}},P=[{key:"zoomin"},{key:"zoomout"},{key:"exright"}],N={showMode:"normal",title:{display:"text"}},R={zoomInfo:{index:3,list:[1,2,3,5,8,13,21]},scroll:{display:"none"},title:{display:"text",label:"K线"},axisX:{lines:0,display:"none",type:"normal",format:"date"},axisY:{lines:3,left:{display:"both",middle:"none",format:"price"},right:{display:"both",middle:"none",format:"price"}},lines:[{className:function(t,i){j(this,t),this.rectMain=i,this.linkInfo=t.father.linkInfo,this.source=t.father,this.maxmin=t.maxmin,this.onPaint=function(t){this.data=this.source.getData(t),this.codeInfo=this.source.getData("INFO");let i,e,s=this.color.red;d(this.context,s);let n=Object(Y.d)(this.codeInfo,"before",0);for(let t=0,o=this.linkInfo.minIndex;o<=this.linkInfo.maxIndex;t++,o++)o>0&&(n=Object(Y.d)(this.data,"close",o-1)),((i=Object(Y.d)(this.data,"open",o))<(e=Object(Y.d)(this.data,"close",o))||i===e&&e>=n)&&I(this.context,{filled:!1,index:t,spaceX:this.linkInfo.spaceX,unitX:this.linkInfo.unitX,unitY:this.maxmin.unitY,maxmin:this.maxmin,rect:this.rectMain,fillclr:s},[e,Object(Y.d)(this.data,"high",o),Object(Y.d)(this.data,"low",o),i]);u(this.context),s=this.color.green,d(this.context,s);for(let t=0,o=this.linkInfo.minIndex;o<=this.linkInfo.maxIndex;t++,o++)o>0&&(n=Object(Y.d)(this.data,"close",o-1)),((i=Object(Y.d)(this.data,"open",o))>(e=Object(Y.d)(this.data,"close",o))||i===e&&e<n)&&I(this.context,{filled:!0,index:t,spaceX:this.linkInfo.spaceX,unitX:this.linkInfo.unitX,unitY:this.maxmin.unitY,maxmin:this.maxmin,rect:this.rectMain,fillclr:s},[i,Object(Y.d)(this.data,"high",o),Object(Y.d)(this.data,"low",o),e]);u(this.context)}},extremum:{method:"normal",maxvalue:["high"],minvalue:["low"]}},{className:function(t,i){j(this,t),this.rectMain=i,this.linkInfo=t.father.linkInfo,this.source=t.father,this.symbol=t.layout.symbol,this.onPaint=function(t){if(this.data=this.source.getData(t),this.rightData=this.source.getData("RIGHT"),Object(Y.j)(this.rightData)<1)return;const i=g(this.context,"▲",this.symbol.font,this.symbol.pixel);for(let t=0;t<this.rightData.value.length;t++){const e=E(this.data,Object(Y.d)(this.rightData,"time",t))-this.linkInfo.minIndex,s=this.rectMain.left+e*(this.linkInfo.unitX+this.linkInfo.spaceX)+Math.floor(this.linkInfo.unitX/2);if(s<this.rectMain.left)continue;let n=this.color.button;"no"!==this.linkInfo.rightMode&&(n=this.color.vol),x(this.context,s-Math.floor(i/2),this.rectMain.top+this.rectMain.height-this.symbol.pixel-this.symbol.spaceY,"▲",this.symbol.font,this.symbol.pixel,n,{y:"top"})}}}},{className:_,info:{txt:"5:",labelY:"value",format:"price"},formula:{key:"DAYM1",command:"out = this.MA('close',5)"}},{className:_,info:{txt:"10:",labelY:"value",format:"price"},formula:{key:"DAYM2",command:"out = this.MA('close',10)"}},{className:_,info:{txt:"20:",labelY:"value",format:"price"},formula:{key:"DAYM3",command:"out = this.MA('close',20)"}},{className:_,info:{txt:"60:",labelY:"value",format:"price"},formula:{key:"DAYM4",command:"out = this.MA('close',60)"}}]},H={title:{display:"text",label:"VOL"},axisX:{lines:0,display:"both",type:"normal",format:"date"},axisY:{lines:1,left:{display:"nofoot",middle:"none",format:"vol"},right:{display:"nofoot",middle:"none",format:"vol"}},lines:[{className:function(t,i){j(this,t),this.rectMain=i,this.linkInfo=t.father.linkInfo,this.source=t.father,this.maxmin=t.maxmin,this.onPaint=function(t){this.data=this.source.getData(t),d(this.context,this.color.red);for(let t=0,i=this.linkInfo.minIndex;i<=this.linkInfo.maxIndex;t++,i++)parseFloat(Object(Y.d)(this.data,"open",i))<=parseFloat(Object(Y.d)(this.data,"close",i))&&M(this.context,{filled:"white"===this.color.sys,index:t,spaceX:this.linkInfo.spaceX,unitX:this.linkInfo.unitX,unitY:this.maxmin.unitY,maxmin:this.maxmin,rect:this.rectMain,fillclr:this.color.red},Object(Y.d)(this.data,"vol",i));u(this.context),d(this.context,this.color.green);for(let t=0,i=this.linkInfo.minIndex;i<=this.linkInfo.maxIndex;t++,i++)parseFloat(Object(Y.d)(this.data,"open",i))>parseFloat(Object(Y.d)(this.data,"close",i))&&M(this.context,{filled:!0,index:t,spaceX:this.linkInfo.spaceX,unitX:this.linkInfo.unitX,unitY:this.maxmin.unitY,maxmin:this.maxmin,rect:this.rectMain,fillclr:this.color.green},Object(Y.d)(this.data,"vol",i));u(this.context)}},extremum:{method:"normal",maxvalue:["vol"],minvalue:[0]},info:{labelY:"vol",format:"vol"}},{className:_,info:{txt:"5:",labelY:"value",format:"vol"},formula:{key:"MVOL1",command:"out = this.MA('vol',5)"}},{className:_,info:{txt:"10:",labelY:"value",format:"vol"},formula:{key:"MVOL2",command:"out = this.MA('vol',10)"}},{className:_,info:{txt:"20:",labelY:"value",format:"vol"},formula:{key:"MVOL3",command:"out = this.MA('vol',20)"}}]},S={title:{display:"none"},axisX:{lines:3,display:"none",type:"day1",format:"tradetime"},axisY:{lines:3,left:{display:"both",middle:"before",format:"price"},right:{display:"both",middle:"before",format:"rate"}},lines:[{className:_,extremum:{method:"fixedLeft",maxvalue:["high"],minvalue:["low"]},info:{labelX:"idx",labelY:"close"}},{className:_,formula:{key:"NOWM1",command:"out = this.AVGPRC()"}}]},z={title:{display:"none"},axisX:{lines:3,display:"both",type:"day1",format:"tradetime"},axisY:{lines:1,left:{display:"nofoot",middle:"none",format:"vol"},right:{display:"nofoot",middle:"none",format:"vol"}},lines:[{className:A,extremum:{method:"normal",maxvalue:["decvol"],minvalue:[0]},info:{labelX:"idx",labelY:"decvol",color:"vol"}}]},K={title:{display:"none"},axisX:{lines:4,display:"none",type:"day5",format:"date"},axisY:{lines:3,left:{display:"both",middle:"before",format:"price"},right:{display:"both",middle:"before",format:"rate"}},lines:[{className:_,extremum:{method:"fixedLeft",maxvalue:["close"],minvalue:["close"]},info:{showSort:"idx",labelX:"time",labelY:"close"}},{className:_,info:{showSort:"idx"},formula:{key:"NOWDAY5",command:"out = this.AVGPRC()"}}]},W={title:{display:"none"},axisX:{lines:4,display:"block",type:"day5",format:"date"},axisY:{lines:1,left:{display:"nofoot",middle:"none",format:"vol"},right:{display:"nofoot",middle:"none",format:"vol"}},lines:[{className:A,extremum:{method:"normal",maxvalue:["vol"],minvalue:[0]},info:{showSort:"idx",labelX:"time",labelY:"vol",color:"vol"}}]},G={title:{display:"text",label:"NORMAL"},axisX:{lines:0,display:"none",type:"normal",format:"date"},axisY:{lines:1,left:{display:"both",middle:"none",format:"price"},right:{display:"both",middle:"none",format:"price"}},lines:[{className:_}]};var B=e(2);function V(t){const i={shape:"arc",maxR:4,hotIdx:0,visible:!0,status:"enabled"};j(this,t),this.init=function(t,e){this.callback=e,this.rectMain=t.rectMain||{left:0,top:0,width:25,height:25},this.layout=Object(n.u)(t.layout,F),this.config=Object(n.u)(t.config,i),this.info=t.info||[{map:"+"}],this.checkConfig()},this.checkConfig=function(){X(this.layout),this.config.maxR*=this.scale},this.setStatus=function(t){this.config.status!==t&&(this.config.status=t)},this.onClick=function(t){this.config.visible&&(this.info.length>1&&(this.config.hotIdx++,this.config.hotIdx%=this.info.length,this.onPaint()),this.config.hotIdx>=0&&this.config.hotIdx<this.info.length?this.callback({self:this,info:this.info[this.config.hotIdx]}):this.callback({self:this}),t.break=!0)},this.onPaint=function(){if(!this.config.visible)return;o(this.context,this.scale),"disabled"===this.config.status?d(this.context,this.color.grid):d(this.context,this.color.button);const t={xx:Math.floor(this.rectMain.width/2),yy:Math.floor(this.rectMain.height/2),offset:4*this.scale},i=this.info[this.config.hotIdx];switch(this.config.shape){case"set":"focused"===this.config.status?(e=this.context,s=this.rectMain.left+t.xx,n=this.rectMain.top+t.xx,void 0!==(f={r:Math.round(this.config.maxR),clr:this.color.red})&&f.r>0&&(d(e,f.clr),l(e,s-f.r,n),c(e,s+f.r,n),c(e,s,n+2*f.r),c(e,s-f.r,n),function(t,i){t.fillStyle=i,t.fill()}(e,f.clr),y(e,s,n,f.r,f.clr),u(e)),t.yy=t.xx):function(t,i,e,s,n,o){void 0!==s&&s.r>0&&(d(t,s.clr),y(t,i,e,s.r,s.clr),u(t)),void 0!==n&&n.r>0&&(d(t,n.clr),y(t,i,e,n.r,n.clr),u(t)),void 0!==o&&o.r>0&&(d(t,o.clr),y(t,i,e,o.r,o.clr),u(t))}(this.context,this.rectMain.left+t.xx,this.rectMain.top+t.xx,{r:Math.round(this.config.maxR),clr:this.color.vol});break;case"arc":p(this.context,this.rectMain.left+t.xx,this.rectMain.top+t.xx,t.xx);break;case"box":r(this.context,this.rectMain.left,this.rectMain.top,this.rectMain.width,this.rectMain.height);break;case"range":case"radio":case"checkbox":p(this.context,this.rectMain.left+t.xx,this.rectMain.top+t.xx,t.xx)}var e,s,n,f;switch(u(this.context),"disabled"===this.config.status?d(this.context,this.color.grid):d(this.context,this.color.button),i.map){case"+":h(this.context,this.rectMain.left+t.xx,this.rectMain.top+t.offset,this.rectMain.top+this.rectMain.height-t.offset),a(this.context,this.rectMain.left+t.offset,this.rectMain.left+this.rectMain.width-t.offset,this.rectMain.top+t.yy);break;case"-":a(this.context,this.rectMain.left+t.offset,this.rectMain.left+this.rectMain.width-t.offset,this.rectMain.top+t.yy);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":x(this.context,this.rectMain.left+t.xx,this.rectMain.top+t.yy,i.map,this.layout.title.font,this.layout.title.pixel,this.color.baktxt,{x:"center",y:"middle"});break;case"*":x(this.context,this.rectMain.left+t.xx,this.rectMain.top+t.yy-2*this.scale,"...",this.layout.title.font,this.layout.title.pixel,this.color.baktxt,{x:"center",y:"middle"});break;case"left":case"right":break;default:x(this.context,this.rectMain.left+t.xx,this.rectMain.top+t.yy,i.map,this.layout.symbol.font,this.layout.symbol.pixel,this.color.button,{x:"center",y:"middle"})}u(this.context)}}function U(t,i,e){j(this,t),this.rectMain=i,this.linkInfo=t.father.linkInfo,this.static=t.static,this.align=e,this.axisY=t.config.axisY,this.maxmin=t.maxmin,this.text=t.layout.title,this.onPaint=function(){if("none"===this.axisY[this.align].display)return;if(this.linkInfo.hideInfo)return;let t,i,e,s,o;const h="phone"===this.axisPlatform?2*this.scale:-2*this.scale;"left"===this.align?(o="phone"===this.axisPlatform?"start":"end",t=this.rectMain.left+h,i=this.rectMain.top+this.scale):(o="phone"===this.axisPlatform?"end":"start",t=this.rectMain.left+this.rectMain.width-h,i=this.rectMain.top+this.scale),"noupper"!==this.axisY[this.align].display&&(i=this.rectMain.top+this.scale,s="before"!==this.axisY[this.align].middle?this.color.axis:this.color.red,e=Object(n.c)(this.maxmin.max,this.axisY[this.align].format,this.static.decimal,this.static.before),x(this.context,t,i,e,this.text.font,this.text.pixel,s,{x:o,y:"top"})),"nofoot"!==this.axisY[this.align].display&&(s="before"!==this.axisY[this.align].middle?this.color.axis:this.color.green,i=this.rectMain.top+this.rectMain.height-this.scale,e=Object(n.c)(this.maxmin.min,this.axisY[this.align].format,this.static.decimal,this.static.before),x(this.context,t,i,e,this.text.font,this.text.pixel,s,{x:o,y:"bottom"}));const a=this.rectMain.height/(this.axisY.lines+1);for(let h=0;h<this.axisY.lines;h++)e=this.maxmin.max-a*(h+1)/this.maxmin.unitY,i=this.rectMain.top+Math.round((h+1)*a),s=this.color.axis,"none"!==this.axisY[this.align].middle&&(h+1<Math.round(this.axisY.lines/2)&&(s=this.color.red),h+1>Math.round(this.axisY.lines/2)&&(s=this.color.green),h+1===Math.round(this.axisY.lines/2)&&(e="zero"===this.axisY[this.align].middle?0:this.static.before)),e=Object(n.c)(e,this.axisY[this.align].format,this.static.decimal,this.static.before),x(this.context,t,i,e,this.text.font,this.text.pixel,s,{x:o,y:"middle"})}}function q(t){j(this,t),this.linkInfo=t.linkInfo,this.static=this.father.dataLayer.static,this.data={},this.maxmin={},this.init=function(t,i){this.callback=i,this.rectMain=t.rectMain||{left:0,top:0,width:400,height:200},this.layout=Object(n.u)(t.layout,F),this.config=Object(n.b)(t.config),this.buttons=t.buttons||[],this.scroll=t.config.scroll||{display:"none"},this.childCharts={},this.checkConfig(),this.setPublicRect(),this.childDraws={},this.setChildDraw(),this.childLines={},this.setChildLines(),this.setButtons(),this.setScroll()},this.checkConfig=function(){X(this.layout),void 0!==this.config.zoomInfo&&(this.linkInfo.unitX=this.config.zoomInfo.list[this.config.zoomInfo.index]*this.scale,this.linkInfo.unitX<this.scale&&(this.linkInfo.unitX=this.scale),this.linkInfo.spaceX=this.linkInfo.unitX/4)},this.setPublicRect=function(){this.rectChart=Object(n.t)(this.rectMain,this.layout.margin);const t={width:this.layout.axisX.width};this.rectTitle={left:this.rectMain.left,top:this.rectMain.top,width:0,height:0},this.rectMess={left:this.rectMain.left,top:this.rectMain.top,width:0,height:0},"none"!==this.config.title.display&&(this.rectTitle={left:this.rectChart.left,top:this.rectChart.top,width:t.width,height:this.layout.title.height},this.rectMess={left:this.rectChart.left+t.width+this.scale,top:this.rectChart.top,width:this.rectChart.width-2*t.width,height:this.layout.title.height}),t.left=this.rectChart.left,t.right=this.rectChart.left+this.rectChart.width,t.top=this.rectTitle.top+this.rectTitle.height,t.bottom=this.rectChart.top+this.rectChart.height,"phone"!==this.axisPlatform&&("none"!==this.config.axisY.left.display&&(t.left+=this.layout.axisX.width),"none"!==this.config.axisY.right.display&&(t.right-=this.layout.axisX.width)),"none"!==this.config.axisX.display&&(t.bottom-=this.layout.axisX.height),"none"!==this.scroll.display&&(t.bottom-=this.layout.scroll.size),this.rectGridLine={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},this.rectAxisYLeft={left:this.rectChart.left,top:t.top,width:t.width,height:t.bottom-t.top},this.rectAxisYRight={left:this.rectChart.left+this.rectChart.width-t.width,top:t.top,width:t.width,height:t.bottom-t.top},this.rectChart=Object(n.t)(this.rectGridLine,this.layout.offset),this.rectAxisX={left:0,top:t.bottom,width:0,height:0},"none"!==this.config.axisX.display&&(this.rectAxisX={left:t.left,top:t.bottom+this.scale,width:t.right-t.left,height:this.layout.axisX.height}),"none"!==this.scroll.display&&(this.rectScroll={left:t.left,top:this.rectAxisX.top+this.rectAxisX.height+this.scale,width:t.right-t.left,height:this.layout.scroll.size})},this.getLineDataKey=function(t){return void 0===t.formula?this.hotKey:t.formula.key},this.setChildLines=function(){let t,i=0;for(let e=0;e<this.config.lines.length;e++){const s=this.config.lines[e].className;t=new s(this,this.rectChart),this.childLines["NAME"+e]=t,t.hotKey=this.getLineDataKey(this.config.lines[e]),Object(n.o)(s,[_,A])&&(t.info={labelX:"idx",labelY:"value"},void 0!==this.config.lines[e].info&&(t.info=this.config.lines[e].info),"day5"===this.config.axisX.type&&(t.info.skips=Object(Y.i)(this.father.dataLayer.tradeTime)),void 0===t.info.color&&(t.info.color=this.color.line[i%this.color.line.length]),i++)}},this.setChildDraw=function(){let t;t=new function(t,i,e){j(this,t),this.rectMain=i,this.rectChart=e,this.static=t.father.static,this.linkInfo=t.father.linkInfo,this.axisXInfo=t.config.axisX,this.axisYInfo=t.config.axisY,this.maxmin=t.maxmin,this.axisX=t.layout.axisX,this.onPaint=function(t,i,e){if(!1===Object(n.p)(this.rectChart,t.x))return;let s,o=t.x,h=t.y;const a="phone"===this.axisPlatform?2*this.scale:-2*this.scale;if(Object(n.q)(this.rectChart,t.y)){void 0===e?e=this.maxmin.max-(t.y-this.rectChart.top)/this.maxmin.unitY:h=(this.maxmin.max-e)*this.maxmin.unitY+this.rectChart.top,b(this.context,this.rectMain.left,h,this.rectMain.left+this.rectMain.width,h,this.color.grid);let i="phone"===this.axisPlatform?"start":"end";"none"!==this.axisYInfo.left.display&&(s=Object(n.c)(e,this.axisYInfo.left.format,this.static.decimal,this.static.before),o=this.rectMain.left+a,v(this.context,o,h,s,{font:this.axisX.font,pixel:this.axisX.pixel,spaceX:this.axisX.spaceX,clr:this.color.txt,bakclr:this.color.grid,x:i,y:"middle"})),"none"!==this.axisYInfo.right.display&&(s=Object(n.c)(e,this.axisYInfo.right.format,this.static.decimal,this.static.before),i="phone"===this.axisPlatform?"end":"start",o=this.rectMain.left+this.rectMain.width-a,v(this.context,o,h,s,{font:this.axisX.font,pixel:this.axisX.pixel,spaceX:this.axisX.spaceX,clr:this.color.txt,bakclr:this.color.grid,x:i,y:"middle"}))}if(b(this.context,t.x,this.rectMain.top,t.x,this.rectMain.top+this.rectMain.height-1,this.color.grid),"none"!==this.axisXInfo.display){o=t.x;const e=Math.floor((this.axisX.height-this.axisX.pixel-this.scale)/2);h=this.rectMain.top+this.rectMain.height+e,s=Object(n.e)(this.father.data.key,i);const l=Math.round(g(this.context,s,this.axisX.font,this.axisX.pixel)/2);let c="center";o-l<this.rectMain.left+a&&(o=this.rectMain.left+a,c="start"),o+l>this.rectMain.left+this.rectMain.width-a&&(o=this.rectMain.left+this.rectMain.width-a,c="end"),v(this.context,o,h,s,{font:this.axisX.font,pixel:this.axisX.pixel,spaceX:this.axisX.spaceX,clr:this.color.txt,bakclr:this.color.grid,x:c,y:"top"})}}}(this,this.rectGridLine,this.rectChart),this.childDraws.CURSOR=t,"none"!==this.config.title.display&&(t=new function(t,i,e){j(this,t),this.rectMain=i,this.rectMess=e,this.linkInfo=t.father.linkInfo,this.title=t.layout.title,this.titleInfo=t.config.title,this.onPaint=function(t){if("none"===this.titleInfo.display||this.linkInfo.hideInfo)return;f(this.context,this.rectMain.left+this.scale,this.rectMain.top+this.scale,this.rectMess.left+this.rectMess.width-2*this.scale,this.rectMain.height-2*this.scale,this.color.back);let i=this.color.txt;const e=Math.round((this.title.height-this.title.pixel)/2)-this.scale,s=this.rectMess.top+e;void 0!==this.titleInfo.label&&x(this.context,this.rectMain.left+this.scale,s,this.titleInfo.label,this.title.font,this.title.pixel,i);let n=this.rectMess.left+this.scale;for(let e=0;e<t.length;e++)i=this.color.line[e],void 0!==t[e].txt&&(x(this.context,n,s,t[e].txt,this.title.font,this.title.pixel,i),n+=g(this.context,t[e].txt,this.title.font,this.title.pixel)+this.title.spaceX),void 0!==t[e].value&&(x(this.context,n,s," "+t[e].value,this.title.font,this.title.pixel,i),n+=g(this.context," "+t[e].value,this.title.font,this.title.pixel)+this.title.spaceX)}}(this,this.rectTitle,this.rectMess),this.childDraws.TITLE=t),"none"!==this.config.axisY.left.display&&(t=new U(this,this.rectAxisYLeft,"left"),this.childDraws.AXISY_LEFT=t),"none"!==this.config.axisY.right.display&&(t=new U(this,this.rectAxisYRight,"right"),this.childDraws.AXISY_RIGHT=t),"none"!==this.config.axisX.display&&(t=new function(t,i){j(this,t),this.rectMain=i,this.linkInfo=t.father.linkInfo,this.axisX=t.config.axisX,this.maxmin=t.maxmin,this.text=t.layout.axisX,this.onPaint=function(){if(this.data=t.data,"none"===this.axisX.display)return;let i,e,s;i=this.rectMain.left+this.text.spaceX;const o=this.rectMain.top+this.rectMain.height/2;if("block"===this.axisX.display){let t=-1,h=0;const a=this.linkInfo.maxCount/(this.axisX.lines+1);s=this.rectMain.width/(this.axisX.lines+1);for(let l=this.linkInfo.minIndex;l<=this.linkInfo.maxIndex;l++){const c=Object(Y.d)(this.data,"idx",l);c<0||(h=Math.floor(c/a))>t&&(t=h,i=this.rectMain.left+s/2+s*t,e=Object(n.h)(Object(Y.d)(this.data,"time",l)),x(this.context,i,o,e,this.text.font,this.text.pixel,this.color.axis,{y:"middle",x:"center"}))}}else"tradetime"===this.axisX.format?(this.tradeTime=this.father.father.dataLayer.tradeTime,e=Object(n.e)(this.data.key,0,this.tradeTime[0].begin),x(this.context,i,o,e,this.text.font,this.text.pixel,this.color.axis,{y:"middle"}),i=this.rectMain.left+this.rectMain.width-3,e=Object(n.e)(this.data.key,0,this.tradeTime[this.tradeTime.length-1].end),x(this.context,i,o,e,this.text.font,this.text.pixel,this.color.axis,{y:"middle",x:"end"})):(e=Object(Y.d)(this.data,"time",this.linkInfo.minIndex),e=Object(n.e)(this.data.key,e,this.maxmin.min),x(this.context,i,o,e,this.text.font,this.text.pixel,this.color.axis,{y:"middle"}),i=this.rectMain.left+this.rectMain.width-3,e=Object(Y.d)(this.data,"time",this.linkInfo.maxIndex),e=Object(n.e)(this.data.key,e,this.maxmin.max),x(this.context,i,o,e,this.text.font,this.text.pixel,this.color.axis,{y:"middle",x:"end"}))}}(this,this.rectAxisX),this.childDraws.AXISX=t),t=new function(t,i){j(this,t),this.rectMain=i,this.axisX=t.config.axisX,this.axisY=t.config.axisY,this.onPaint=function(){if(d(this.context,this.color.grid),a(this.context,this.rectMain.left,this.rectMain.left+this.rectMain.width,this.rectMain.top),this.axisY.lines>0){const t=this.rectMain.height/(this.axisY.lines+1);for(let i=0;i<this.axisY.lines;i++)a(this.context,this.rectMain.left,this.rectMain.left+this.rectMain.width,this.rectMain.top+Math.round((i+1)*t))}if("none"!==this.axisX.display&&a(this.context,this.rectMain.left,this.rectMain.left+this.rectMain.width,this.rectMain.top+this.rectMain.height),this.axisX.lines>0){const t=this.rectMain.width/(this.axisX.lines+1);for(let i=0;i<this.axisX.lines;i++)h(this.context,this.rectMain.left+Math.round((i+1)*t),this.rectMain.top,this.rectMain.top+this.rectMain.height)}"phone"!==this.axisPlatform&&(h(this.context,this.rectMain.left,this.rectMain.top,this.rectMain.top+this.rectMain.height),h(this.context,this.rectMain.left+this.rectMain.width,this.rectMain.top,this.rectMain.top+this.rectMain.height)),u(this.context)}}(this,this.rectGridLine),this.childDraws.GRID=t},this.setScroll=function(){if("none"===this.scroll.display)return;const t=new function(t){const i={shape:"fixed",direct:"horizontal",range:100,select:{min:40,max:60},status:"enabled",txt:{}};j(this,t),this.init=function(t,e){this.callback=e,this.rectMain=t.rectMain||{left:0,top:0,width:200,height:25},this.layout=Object(n.u)(t.layout,F),this.config=Object(n.u)(t.config,i),this.checkConfig(),this.setPublicRect()},this.checkConfig=function(){X(this.layout)},this.setPublicRect=function(){const t=this.config.range;let i,e,s,o;this.rectChart=Object(n.t)(this.rectMain,this.layout.margin),"horizontal"===this.config.direct&&(i=this.rectMain.width/(t-1),o=this.rectMain.height-2*this.scale,e=this.rectMain.left+i*this.config.select.min,s=this.rectMain.left+i*this.config.select.max,"free"===this.config.shape?(this.rectMin={left:e-this.layout.scroll.size/2,top:this.rectMain.top+this.scale,width:this.layout.scroll.size,height:o},this.rectMax={left:s-this.layout.scroll.size/2,top:this.rectMain.top+this.scale,width:this.layout.scroll.size,height:o},this.rectMid={left:e+this.layout.scroll.size/2,top:this.rectMain.top+this.scale,width:s-e-this.layout.scroll.size,height:o}):this.rectMid={left:e,top:this.rectMain.top+this.scale,width:s-e,height:o})},this.onPaint=function(){o(this.context,this.scale),this.drawClear(),this.drawGridline(),this.setPublicRect(),this.drawButton()},this.onChange=function(t){this.config=Object(n.u)(t,this.config),this.config.select.max>this.config.range&&(this.config.select.max=this.config.range-1),t.iscall&&this.callback({self:this,minIndex:this.config.select.min})},this.findMouseIndex=function(t){const i=this.config.range,e=this.rectMain.width/(i-1);return Math.round((t-this.rectMain.left)/e)},this.checkMin=function(t){return t<0?0:t>this.config.range-(this.config.select.max-this.config.select.min+1)?this.config.range-(this.config.select.max-this.config.select.min+1):t},this.onInit=function(){L("default"),this.who=void 0},this.onMouseOut=function(){L("default"),this.who=void 0},this.onMouseDown=function(t){const i=t.mousePos;Object(n.r)(this.rectMin,i)?this.who="min":Object(n.r)(this.rectMax,i)?this.who="max":Object(n.r)(this.rectMid,i)?(this.who="mid",this.index=this.findMouseIndex(i.x)):this.who=void 0},this.onMouseUp=function(t){if("free"!==this.config.shape&&void 0===this.who){const i=t.mousePos;let e=this.findMouseIndex(i.x)-Math.floor((this.config.select.max-this.config.select.min)/2);e=this.checkMin(e),this.onChange({min:e,iscall:!0})}this.who=void 0},this.onMouseMove=function(t){const i=t.mousePos;if(Object(n.r)(this.rectMin,i)||Object(n.r)(this.rectMax,i)?L("col-resize"):Object(n.r)(this.rectMid,i)?L("move"):L("default"),void 0!==this.who){let t,e;const s=this.findMouseIndex(i.x);"free"===this.config.shape?(s<this.config.select.max?"max"===this.who?e=s:"min"===this.who&&(t=s):s>=this.config.select.max&&("min"===this.who?(t=this.config.select.max,e=s,this.who="max"):"max"===this.who&&(e=s)),this.onChange({min:t,max:e,iscall:!0})):(t=this.config.select.min+s-this.index,this.index=s,t=this.checkMin(t),this.onChange({min:t,iscall:!0}))}},this.drawClear=function(){f(this.context,this.rectMain.left,this.rectMain.top,this.rectMain.width,this.rectMain.height,this.color.back)},this.drawGridline=function(){d(this.context,this.color.grid),r(this.context,this.rectMain.left,this.rectMain.top,this.rectMain.width+this.scale/2,this.rectMain.height),u(this.context)},this.drawButton=function(){if("horizontal"===this.config.direct){const t=(this.rectChart.height-this.layout.scroll.height)/2;void 0!==this.config.txt.head&&x(this.context,this.rectChart.left+this.scale,this.rectChart.top+t,this.config.txt.head,this.layout.scroll.font,this.layout.scroll.pixel,this.color.axis),void 0!==this.config.txt.tail&&x(this.context,this.rectChart.left+this.rectChart.width-this.scale,this.rectChart.top+t,this.config.txt.tail,this.layout.scroll.font,this.layout.scroll.pixel,this.color.axis,{x:"end"}),d(this.context,this.color.colume),r(this.context,this.rectMid.left,this.rectMid.top,this.rectMid.width,this.rectMid.height),f(this.context,this.rectMid.left,this.rectMid.top,this.rectMid.width,this.rectMid.height,this.color.box),"free"===this.config.shape&&(f(this.context,this.rectMin.left,this.rectMin.top,this.rectMin.width,this.rectMin.height,this.color.colume),f(this.context,this.rectMax.left,this.rectMax.top,this.rectMax.width,this.rectMax.height,this.color.colume)),u(this.context);const i=g(this.context,this.config.txt.left,this.layout.scroll.font,this.layout.scroll.pixel)+2*this.scale;void 0!==this.config.txt.left&&this.rectMid.width>i&&x(this.context,this.rectMid.left+this.scale,this.rectMid.top+t,this.config.txt.left,this.layout.scroll.font,this.layout.scroll.pixel,this.color.axis),void 0!==this.config.txt.right&&this.rectMid.width>2*i&&x(this.context,this.rectMid.left+this.rectMid.width-this.scale,this.rectMid.top+t,this.config.txt.right,this.layout.scroll.font,this.layout.scroll.pixel,this.color.axis,{x:"end"})}}}(this);t.name="HSCROLL",this.childCharts[t.name]=t,t.init({rectMain:this.rectScroll,config:{width:8}},t=>{const i=t.self.father;i.father.linkInfo.minIndex!==t.minIndex&&(i.father.linkInfo.minIndex=t.minIndex,i.father.onPaint())})},this.createButton=function(t){if(void 0!==this.childCharts[t])return this.childCharts[t];const i=new V(this);return i.name=t,this.childCharts[t]=i,i},this.hasButton=function(t,i){for(let e=0;e<i.length;e++)if(t===i[e].key)return!0;return!1},this.setButtons=function(){let t,i,e,s=25*this.scale;(this.hasButton("zoomin",this.buttons)||this.hasButton("zoomout",this.buttons))&&(t=this.createButton("zoomin"),i=Math.floor((this.rectChart.width-2*(s+s))/4),e=this.rectChart.top+.95*this.rectChart.height-s,t.init({rectMain:{left:i,top:e,width:s,height:s},info:[{map:"-"}]},()=>{this.config.zoomInfo.index>0&&(this.config.zoomInfo.index--,this.setZoomInfo(this.config.zoomInfo.index),this.father.onPaint())}),i+=2*s,(t=this.createButton("zoomout")).init({rectMain:{left:i,top:e,width:s,height:s},info:[{map:"+"}]},()=>{this.config.zoomInfo.index<this.config.zoomInfo.list.length-1&&(this.config.zoomInfo.index++,this.setZoomInfo(this.config.zoomInfo.index),this.father.onPaint())})),this.hasButton("exright",this.buttons)&&(t=this.createButton("exright"),s=g(this.context,"前复权",this.layout.symbol.font,this.layout.symbol.pixel),i=this.rectMain.left+this.rectMain.width-s-2*this.layout.symbol.spaceX,e=(this.rectMess.height-this.layout.symbol.pixel-2*this.layout.symbol.spaceY)/2,t.init({rectMain:{left:i,top:this.rectMess.top+e,width:s+this.layout.symbol.spaceX,height:this.rectMess.height-2*e},config:{shape:"box"},info:[{map:"不除权",value:"no"},{map:"前复权",value:"forword"}]},t=>{this.father.linkInfo.rightMode=t.info.value,this.father.fastDrawEnd(),this.father.onPaint()}),t.hotIdx=0)},this.getDecimal=function(t){return"vol"===t||"decvol"===t?0:this.static.decimal},this.addLine=function(t){this.config.lines.push(t)},this.removeLine=function(t){for(let i=0;i<this.config.lines.length;i++)void 0!==this.config.lines[i].name&&this.config.lines[i].name===t&&this.config.lines.splice(i,1)},this.setZoomInfo=function(t){this.linkInfo.unitX=this.config.zoomInfo.list[t]*this.scale,this.linkInfo.unitX<this.scale&&(this.linkInfo.unitX=this.scale),this.linkInfo.spaceX=this.linkInfo.unitX/4,this.linkInfo.spaceX<this.scale&&(this.linkInfo.spaceX=this.scale),this.childCharts.zoomin&&(0===this.config.zoomInfo.index?this.childCharts.zoomin.setStatus("disabled"):this.childCharts.zoomin.setStatus("enabled")),this.childCharts.zoomout&&(this.config.zoomInfo.index===this.config.zoomInfo.list.length-1?this.childCharts.zoomout.setStatus("disabled"):this.childCharts.zoomout.setStatus("enabled")),this.father.fastDrawEnd()},this.setHotButton=function(t){for(const i in this.childCharts)this.childCharts[i]===t?this.childCharts[i].focused=!0:this.childCharts[i].focused=!1},this.drawClear=function(){f(this.context,this.rectMain.left,this.rectMain.top,this.rectMain.width,this.rectMain.height,this.color.back),d(this.context,this.color.grid),r(this.context,this.rectMain.left,this.rectMain.top,this.rectMain.width,this.rectMain.height),u(this.context)},this.drawChildCharts=function(){let t;for(const i in this.childCharts)this.childCharts[i].focused?t=this.childCharts[i]:this.childCharts[i].onPaint();t&&t.onPaint()},this.drawChildLines=function(){for(const t in this.childLines)void 0!==this.childLines[t].hotKey?this.childLines[t].onPaint(this.childLines[t].hotKey):this.childLines[t].onPaint(this.hotKey)},this.getMoveData=function(t){let i=this.config.lines;const e=[];if(!Array.isArray(i))return e;let s,o;for(let h=0;h<i.length;h++)void 0!==i[h].info&&(void 0!==i[h].info.labelY?(s=void 0===i[h].formula?Object(Y.d)(this.data,i[h].info.labelY,t):Object(Y.d)(this.father.getData(i[h].formula.key),i[h].info.labelY,t-this.linkInfo.minIndex),o=Object(n.c)(s,i[h].info.format,this.static.decimal),e.push({index:h,txt:i[h].info.txt,value:o})):e.push({index:h,txt:i[h].info.txt}));return e},this.drawTitleInfo=function(t){"none"!==this.config.title.display&&((void 0===t||t<0||t>this.linkInfo.maxIndex)&&(t=this.linkInfo.maxIndex),this.childDraws.TITLE.onPaint(this.getMoveData(t)))},this.drawChildDraw=function(t){void 0!==this.childDraws[t]&&("TITLE"===t?this.drawTitleInfo(this.linkInfo.moveIndex):this.childDraws[t].onPaint())},this.onPaint=function(){var t,i,e,s,n;this.data=this.father.getData(this.hotKey),this.locationData(),this.father.readyData(this.data,this.config.lines),o(this.context,this.scale),this.drawClear(),this.drawChildDraw("GRID"),this.readyDraw(),this.drawChildDraw("AXISX"),this.drawChildDraw("AXISY_LEFT"),this.drawChildDraw("AXISY_RIGHT"),this.drawChildLines(),this.drawChildDraw("TITLE"),this.drawChildCharts(),this.img=(t=this.context,i=this.rectMain.left,e=this.rectMain.top,s=this.rectMain.width,n=this.rectMain.height,t.getImageData(i,e,s,n))},this.getMiddle=function(t){let i=this.config.axisY.left.middle;return"fixedRight"===t&&(i=this.config.axisY.right.middle),"before"===i?this.static.before:0},this.calcMaxMin=function(t,i,e,s){const o={max:0,min:0};if("fixedLeft"===i.method||"fixedRight"===i.method){const t=this.getMiddle(i.method);o.min=.99*t,o.max=1.01*t}if(void 0===t||Object(n.s)(t.value))return o;let h;void 0===e&&(e=0),void 0===s&&(s=t.value.length-1);for(let a=e;a<=s;a++){if(!Object(n.s)(i.maxvalue))for(let e=0;e<i.maxvalue.length;e++)"string"==typeof i.maxvalue[e]&&(h=Object(Y.d)(t,i.maxvalue[e],a))>0&&h>o.max&&(o.max=h);if(!Object(n.s)(i.minvalue))for(let e=0;e<i.minvalue.length;e++)"string"==typeof i.minvalue[e]&&(h=Object(Y.d)(t,i.minvalue[e],a),0===o.min&&(o.min=h),h>0&&h<o.min&&(o.min=h))}if(!Object(n.s)(i.maxvalue))for(let t=0;t<i.maxvalue.length;t++)if("number"==typeof i.maxvalue[t]){o.max=i.maxvalue[t];break}if(!Object(n.s)(i.minvalue))for(let t=0;t<i.minvalue.length;t++)if("number"==typeof i.minvalue[t]){o.min=i.minvalue[t];break}if("fixedLeft"===i.method||"fixedRight"===i.method){const t=this.getMiddle(i.method);o.max===o.min&&(o.max>t&&(o.min=t),o.min<t&&(o.max=t));const e=Math.abs(o.max-t)/t,s=Math.abs(t-o.min)/t;e<.01&&s<.01&&this.static.stktype!==B.STOCK_TYPE_INDEX?(o.min=.99*t,o.max=1.01*t):e>s?o.min=t/(1+e):o.max=t*(1+s),o.min<0&&(o.min=0)}return console.log("getmaxmin",o,e,s),o},this.readyScroll=function(){if("none"!==this.scroll.display&&void 0!==this.childCharts.HSCROLL){let t=Object(Y.d)(this.data,"time",this.linkInfo.minIndex);t=Object(n.e)(this.data.key,t,this.father.dataLayer.tradeTime[0].begin);let i=Object(Y.d)(this.data,"time",this.linkInfo.maxIndex);i=Object(n.e)(this.data.key,i,this.father.dataLayer.tradeTime[this.father.dataLayer.tradeTime.length-1].end);let e=Object(Y.d)(this.data,"time",0);e=Object(n.e)(this.data.key,e,this.father.dataLayer.tradeTime[0].begin);let s=Object(Y.d)(this.data,"time",this.data.value.length-1);s=Object(n.e)(this.data.key,s,this.father.dataLayer.tradeTime[this.father.dataLayer.tradeTime.length-1].end),this.childCharts.HSCROLL.onChange({head:e,tail:s,left:t,right:i,min:this.linkInfo.minIndex,max:this.linkInfo.maxIndex,range:this.data.value.length})}},this.getDataRange=function(t){const i={minIndex:-1,maxIndex:-1};if(Object(n.s)(t.value)||Object(n.s)(this.data.value))return i;const e=Object(Y.d)(this.data,"time",this.linkInfo.minIndex),s=Object(Y.d)(this.data,"time",this.linkInfo.maxIndex);for(let s=0;s<=t.value.length-1;s++)if(Object(Y.d)(t,"time",s)>=e){i.minIndex=s;break}for(let e=t.value.length-1;e>=0;e--)if(Object(Y.d)(t,"time",e)<=s){i.maxIndex=e;break}return i},this.locationData=function(){if(void 0===this.data)return;const t=Object(Y.j)(this.data);"day1"===this.config.axisX.type?T(this.linkInfo,{width:this.rectChart.width,size:t,maxCount:Object(Y.i)(this.father.dataLayer.tradeTime)}):"day5"===this.config.axisX.type?T(this.linkInfo,{width:this.rectChart.width,size:t,maxCount:5*Object(Y.i)(this.father.dataLayer.tradeTime)}):function(t,i){const e=t.unitX/4;t.spaceX=e<w.scale?w.scale:e,t.maxCount=Math.floor(i.width/(t.unitX+t.spaceX));const s=t.maxCount>i.size?i.size:t.maxCount;switch(t.showMode){case"fixed":case"locked":case"move":break;default:t.maxIndex=i.size-1,t.minIndex=i.size-s}}(this.linkInfo,{width:this.rectChart.width,size:t})},this.readyDraw=function(){let t,i;this.readyScroll();for(let e=0;e<this.config.lines.length;e++){if(void 0===this.config.lines[e].extremum)continue;if(Object(n.s)(this.config.lines[e].extremum.maxvalue)&&Object(n.s)(this.config.lines[e].extremum.minvalue))continue;const s=this.config.lines[e].formula;if(void 0!==s){const i=this.father.getData(s.key),n=this.getDataRange(i);t=this.calcMaxMin(i,this.config.lines[e].extremum,n.minIndex,n.maxIndex)}else t=this.calcMaxMin(this.data,this.config.lines[e].extremum,this.linkInfo.minIndex,this.linkInfo.maxIndex);void 0===i?i=t:(i.max=i.max>t.max?i.max:t.max,i.min=i.min<t.min?i.min:t.min)}this.maxmin.max=i.max,this.maxmin.min=i.min,this.maxmin.unitY=(this.rectChart.height-2)/(this.maxmin.max-this.maxmin.min)},this.onClick=function(t){"phone1"!==this.axisPlatform&&(this.linkInfo.showCursorLine=!this.linkInfo.showCursorLine,this.linkInfo.showCursorLine?this.father.eventLayer.boardEvent(this.father,"onMouseMove",t):(t.reDraw=!0,this.father.eventLayer.boardEvent(this.father,"onMouseOut",t)))},this.onLongPress=function(t){this.linkInfo.showCursorLine=!0,this.father.eventLayer.boardEvent(this.father,"onMouseMove",t,this)},this.onMouseOut=function(t){(this.linkInfo.showCursorLine||t.reDraw)&&(this.linkInfo.moveIndex=this.linkInfo.maxIndex,this.onPaint())},this.onMouseWheel=function(t){if(void 0===this.config.zoomInfo)return;const i=Math.floor(t.deltaY/10);if(i>=1){if(this.config.zoomInfo.index>0){if(this.linkInfo.maxIndex<this.data.value.length-1){const t=Math.floor((this.linkInfo.maxIndex+this.linkInfo.minIndex)/2+1);this.linkInfo.moveDate=Object(Y.d)(this.data,"time",t),this.linkInfo.minIndex=-2}else this.linkInfo.minIndex=-1;this.config.zoomInfo.index--,this.setZoomInfo(this.config.zoomInfo.index),this.father.onPaint()}}else if(i<=-1&&this.config.zoomInfo.index<this.config.zoomInfo.list.length-1){if(this.linkInfo.maxIndex<this.data.value.length-1){const t=Math.floor((this.linkInfo.maxIndex+this.linkInfo.minIndex)/2+1);this.linkInfo.moveDate=Object(Y.d)(this.data,"time",t),this.linkInfo.minIndex=-2}else this.linkInfo.minIndex=-1;this.config.zoomInfo.index++,this.setZoomInfo(this.config.zoomInfo.index),this.father.onPaint()}},this.onKeyDown=function(t){t.keyCode},this.onMouseMove=function(t){if(void 0===this.img)return;if(this.linkInfo.hideInfo)return;if(!this.linkInfo.showCursorLine)return;const i=t.mousePos;var e,s,o,h;e=this.context,s=this.img,o=this.rectMain.left,h=this.rectMain.top,e.putImageData(s,o,h);const a=this.getMouseMoveData(i.x);let l,c=a;a>0&&("day1"===this.config.axisX.type||"day5"===this.config.axisX.type?(c%=240,c=Object(Y.g)(c,this.father.dataLayer.tradeTime,this.father.dataLayer.tradeDate),l=function(t,i,e){for(let e=0;e<=t.value.length-1;e++)if(i===Object(Y.d)(t,"idx",e))return e;return-1}(this.data,a)):(c=Object(Y.d)(this.data,"time",a),l=a),Object(n.p)(this.rectChart,i.x)&&this.drawTitleInfo(l),this.linkInfo.moveIndex!==a&&(this.linkInfo.moveIndex=a,this.callback({event:"mousemove",before:a>0?Object(Y.d)(this.data,"close",a-1):Object(Y.d)(this.data,"open",0),data:this.data.value[a]}))),this.childDraws.CURSOR.onPaint(i,c,void 0)},this.getMouseMoveData=function(t){const i=Math.round((t-this.rectChart.left)/(this.linkInfo.unitX+this.linkInfo.spaceX)-.5);return"day1"===this.config.axisX.type?i:"day5"===this.config.axisX.type?i:this.linkInfo.minIndex+i}}var Z=function(t){const i={showMode:"last",fixed:{min:-1,max:-1,left:20,right:20},locked:{index:-1,set:.5},minIndex:-1,maxIndex:-1,hotIndex:-1,showCursorLine:!1,moveIndex:-1,spaceX:2,unitX:5,rightMode:"no",hideInfo:!1};this.context=t,this.father=void 0,this.initChart=function(t,e){this.linkInfo=Object(n.b)(i),this.childCharts={},this.setDataLayer(t),this.setEventLayer(e)},this.clear=function(){this.childCharts={},this.fastDraw=!1,this.dataLayer.clearData(),this.linkInfo=Object(n.b)(i)},this.getChart=function(t){return this.childCharts[t]},this.getEventLayer=function(){return this.eventLayer},this.setEventLayer=function(t){void 0!==t&&(this.eventLayer=t,this.eventLayer.bindChart(this))},this.getDataLayer=function(){return this.dataLayer},this.setDataLayer=function(t){void 0!==t&&(this.dataLayer=t,t.father=this,this.static=this.dataLayer.static)},this.bindData=function(t,i){t.hotKey!==i&&(this.linkInfo.showMode="last",this.linkInfo.minIndex=-1,t.hotKey=i,this.fastDrawEnd())},this.initData=function(t,i){this.dataLayer.initData(t,i)},this.setData=function(t,i,e){let s=e;"string"==typeof e&&(s=JSON.parse(e)),this.dataLayer.setData(t,i,s),this.fastDrawEnd()},this.getData=function(t){if(this.fastDraw&&void 0!==this.fastBuffer[t])return this.fastBuffer[t];const i=this.dataLayer.getData(t,this.linkInfo.rightMode);return this.fastDraw&&(this.fastBuffer[t]=i),i},this.readyData=function(t,i){for(let e=0;e<i.length;e++)void 0!==i[e].formula&&(!this.fastDraw||this.fastDraw&&void 0===this.fastBuffer[i[e].formula.key])&&this.dataLayer.makeLineData({data:t,minIndex:this.linkInfo.minIndex,maxIndex:this.linkInfo.maxIndex},i[e].formula.key,i[e].formula.command)},this.createChart=function(t,i,e,s){let h;switch(i){case"CHART.ORDER":h=new function(t){j(this,t),this.linkInfo=t.linkInfo,this.static=this.father.dataLayer.static,console.log("ClChartOrder",this.static),this.init=function(t){this.rectMain=t.rectMain||{left:0,top:0,width:200,height:300},this.layout=Object(n.u)(t.layout,F),this.config=Object(n.u)(t.config,N),this.showMode=t.config.showMode||"normal",this.checkConfig(),this.setPublicRect()},this.checkConfig=function(){X(this.layout),this.txtLen=g(this.context,"涨",this.layout.digit.font,this.layout.digit.pixel),this.timeLen=g(this.context,"15:30",this.layout.digit.font,this.layout.digit.pixel),this.volLen=g(this.context,"888888",this.layout.digit.font,this.layout.digit.pixel),this.closeLen=g(this.context,"888.88",this.layout.digit.font,this.layout.digit.pixel)},this.setPublicRect=function(){this.rectChart=Object(n.t)(this.rectMain,this.layout.margin)},this.onClick=function(){this.isIndex||("normal"===this.showMode?this.showMode="tiny":this.showMode="normal",this.onPaint())},this.onPaint=function(){console.log("ClChartOrder 1",this.static),this.codeInfo=this.father.getData("INFO"),this.orderData=this.father.getData("NOW"),this.tickData=this.father.getData("TICK"),void 0!==this.orderData&&void 0!==this.tickData&&(this.orderData.coinunit=this.static.coinunit,this.tickData.coinunit=this.static.coinunit,this.isIndex=0===Object(Y.d)(this.codeInfo,"type"),o(this.context,this.scale),this.drawClear(),this.drawReady(),this.isIndex?this.drawIndex():this.drawOrder(),this.drawTick())},this.drawClear=function(){f(this.context,this.rectMain.left,this.rectMain.top,this.rectMain.width,this.rectMain.height,this.color.back)},this.drawReady=function(){let t;void 0===this.tickData&&(this.tickData={key:"TICK",fields:B.FIELD_TICK,value:[]}),void 0===this.orderData&&(this.orderData={key:"NOW",fields:B.FIELD_NOW,value:[]}),t="normal"===this.showMode?this.rectChart.top+10*(this.layout.digit.height+this.layout.digit.spaceX):this.rectChart.top+2*(this.layout.digit.height+this.layout.digit.spaceX),this.isIndex?(t=this.rectChart.top+4*(this.layout.digit.height+this.layout.digit.spaceX),this.rectOrder={left:this.rectChart.left,top:this.rectChart.top,width:this.rectChart.width,height:t}):this.rectOrder={left:this.rectChart.left,top:this.rectChart.top,width:this.rectChart.width,height:t},"none"!==this.config.title.display?this.rectTitle={left:this.rectChart.left,top:t,width:this.rectChart.width,height:this.layout.title.height}:this.rectTitle={left:0,top:0,width:0,height:0},t+=this.rectTitle.height,this.rectTick={left:this.rectChart.left,top:t,width:this.rectChart.width,height:this.rectChart.height-t-this.layout.digit.height/2}},this.getColor=function(t,i){return t>i?this.color.red:t<i?this.color.green:this.color.white},this.drawIndex=function(){d(this.context,this.color.grid),r(this.context,this.rectMain.left,this.rectMain.top,this.rectMain.width,this.rectMain.height);const t=this.rectOrder.height/3,i=this.rectOrder.width/3;let e,s,o,h;s=this.rectOrder.top+Math.floor((t-this.layout.digit.height)/2),e=this.rectOrder.left+(i-this.txtLen)/2,x(this.context,e,s,"涨",this.layout.digit.font,this.layout.digit.pixel,this.color.txt),e=this.rectOrder.left+i+(i-this.txtLen)/2,x(this.context,e,s,"跌",this.layout.digit.font,this.layout.digit.pixel,this.color.txt),e=this.rectOrder.left+2*i+(i-this.txtLen)/2,x(this.context,e,s,"平",this.layout.digit.font,this.layout.digit.pixel,this.color.txt);const l={key:"NOW",fields:B.FIELD_NOW_IDX,value:this.orderData.value};if(s=this.rectOrder.top+t+Math.floor((t-this.layout.digit.height)/2),h=Object(n.f)(Object(Y.d)(l,"ups")),o=g(this.context,h,this.layout.digit.font,this.layout.digit.pixel),e=this.rectOrder.left+(i-o)/2,x(this.context,e,s,h,this.layout.digit.font,this.layout.digit.pixel,this.color.txt),h=Object(n.f)(Object(Y.d)(l,"downs")),o=g(this.context,h,this.layout.digit.font,this.layout.digit.pixel),e=this.rectOrder.left+i+(i-o)/2,x(this.context,e,s,h,this.layout.digit.font,this.layout.digit.pixel,this.color.txt),h=Object(n.f)(Object(Y.d)(l,"mids")),o=g(this.context,h,this.layout.digit.font,this.layout.digit.pixel),e=this.rectOrder.left+2*i+(i-o)/2,x(this.context,e,s,h,this.layout.digit.font,this.layout.digit.pixel,this.color.txt),s=this.rectOrder.top+2*t+Math.floor((t-this.layout.digit.height)/2),h=Object(n.f)(Object(Y.d)(l,"upvol")),o=g(this.context,h,this.layout.digit.font,this.layout.digit.pixel),e=this.rectOrder.left+(i-o)/2,x(this.context,e,s,h,this.layout.digit.font,this.layout.digit.pixel,this.color.txt),h=Object(n.f)(Object(Y.d)(l,"downvol")),o=g(this.context,h,this.layout.digit.font,this.layout.digit.pixel),e=this.rectOrder.left+i+(i-o)/2,x(this.context,e,s,h,this.layout.digit.font,this.layout.digit.pixel,this.color.txt),"none"!==this.config.title.display){a(this.context,this.rectTitle.left,this.rectTitle.left+this.rectTitle.width,this.rectTitle.top),a(this.context,this.rectTitle.left,this.rectTitle.left+this.rectTitle.width,this.rectTitle.top+this.rectTitle.height);const t=g(this.context,"分时成交",this.layout.title.font,this.layout.digit.pixel);e=this.rectTitle.left+(this.rectTitle.width-t)/2,s=this.rectTitle.top+3*this.scale,x(this.context,e,s,"分时成交",this.layout.digit.font,this.layout.digit.pixel,this.color.txt)}u(this.context)},this.drawOrder=function(){const t=this.drawGridLine();if(void 0===this.orderData||this.orderData.value.length<1)return;const i=(this.rectOrder.width-t-2*this.layout.digit.spaceX-this.closeLen-this.volLen)/2;let e=1;"normal"===this.showMode&&(e=5);const s=this.rectOrder.height/(2*e);let o,h,a,l;h=this.rectOrder.top+Math.floor((s-this.layout.digit.height)/2);for(let c=e;c>=1;c--)o=this.rectOrder.left+t+i+this.closeLen,this.linkInfo.hideInfo||(a=Object(Y.d)(this.orderData,"sell"+c),l=this.getColor(a,this.static.before),x(this.context,o,h,Object(n.d)(a,this.static.decimal),this.layout.digit.font,this.layout.digit.pixel,l,{x:"end"})),o+=i+this.volLen+this.layout.digit.spaceX,a=Object(Y.d)(this.orderData,"sellvol"+c),l=this.color.vol,x(this.context,o,h,Object(n.f)(a,100),this.layout.digit.font,this.layout.digit.pixel,l,{x:"end"}),h+=s;for(let c=1;c<=e;c++)o=this.rectOrder.left+t+i+this.closeLen,this.linkInfo.hideInfo||(a=Object(Y.d)(this.orderData,"buy"+c),l=this.getColor(a,this.static.before),x(this.context,o,h,Object(n.d)(a,this.static.decimal),this.layout.digit.font,this.layout.digit.pixel,l,{x:"end"})),o+=i+this.volLen+this.layout.digit.spaceX,a=Object(Y.d)(this.orderData,"buyvol"+c),l=this.color.vol,x(this.context,o,h,Object(n.f)(a,100),this.layout.digit.font,this.layout.digit.pixel,l,{x:"end"}),h+=s},this.drawTick=function(){if(void 0===this.tickData||this.tickData.value.length<1)return;const t=Math.floor(this.rectTick.height/this.layout.digit.height)-1,i=this.tickData.value.length,e=i>t?i-t:0,s=this.rectTick.height/t;let o,h,a,l,c=(this.rectTick.width-4*this.layout.digit.spaceX-this.timeLen-this.closeLen-this.volLen)/2;this.isIndex&&(c=(this.rectTick.width-3*this.layout.digit.spaceX-this.timeLen-this.closeLen)/2),h=this.rectTick.top+2+Math.floor((s-this.layout.digit.pixel)/2);for(let t=i-1;t>=e;t--){let i;o=this.rectTick.left+this.layout.digit.spaceX+this.timeLen,a=Object(Y.d)(this.tickData,"time",t),l=this.color.txt,i=0===t?Object(n.g)(a,"minute"):Object(n.g)(a,"minute",Object(Y.d)(this.tickData,"time",t-1)),x(this.context,o,h,i,this.layout.digit.font,this.layout.digit.pixel,l,{x:"end"}),this.isIndex?(o=this.rectTick.left+this.rectTick.width-this.layout.digit.spaceX,a=Object(Y.d)(this.tickData,"close",t),l=this.getColor(a,this.static.before),x(this.context,o,h,Object(n.d)(a,this.static.decimal),this.layout.digit.font,this.layout.digit.pixel,l,{x:"end"}),h+=s):(o+=c+this.closeLen+this.layout.digit.spaceX,this.linkInfo.hideInfo||(a=Object(Y.d)(this.tickData,"close",t),l=this.getColor(a,this.static.before),x(this.context,o,h,Object(n.d)(a,this.static.decimal),this.layout.digit.font,this.layout.digit.pixel,l,{x:"end"})),o+=c+this.volLen+this.layout.digit.spaceX,a=Object(Y.d)(this.tickData,"decvol",t),l=this.color.vol,x(this.context,o,h,Object(n.f)(a,100),this.layout.digit.font,this.layout.digit.pixel,l,{x:"end"}),h+=s)}},this.drawGridLine=function(){d(this.context,this.color.grid),r(this.context,this.rectMain.left,this.rectMain.top,this.rectMain.width,this.rectMain.height);let t=1;"normal"===this.showMode&&(t=5);let i,e,s,n=0;a(this.context,this.rectOrder.left,this.rectOrder.left+this.rectOrder.width,this.rectOrder.top+Math.floor(this.rectOrder.height/2));const o=["①","②","③","④","⑤"],h=this.rectOrder.height/(2*t);n=g(this.context,"卖①",this.layout.title.font,this.layout.digit.height),e=this.rectOrder.top+Math.floor((h-this.layout.digit.pixel)/2);for(let n=t-1;n>=0;n--)i=this.rectOrder.left+this.layout.digit.spaceX,s="卖"+o[n],x(this.context,i,e,s,this.layout.digit.font,this.layout.digit.pixel,this.color.txt),e+=h;for(let n=0;n<t;n++)i=this.rectOrder.left+this.layout.digit.spaceX,s="买"+o[n],x(this.context,i,e,s,this.layout.digit.font,this.layout.digit.pixel,this.color.txt),e+=h;if("none"!==this.config.title.display){a(this.context,this.rectTitle.left,this.rectTitle.left+this.rectTitle.width,this.rectTitle.top),a(this.context,this.rectTitle.left,this.rectTitle.left+this.rectTitle.width,this.rectTitle.top+this.rectTitle.height),s="normal"===this.showMode?"分时成交 △":"分时成交 ▽";const t=g(this.context,s,this.layout.title.font,this.layout.digit.pixel);i=this.rectTitle.left+(this.rectTitle.width-t)/2,e=this.rectTitle.top+3*this.scale,x(this.context,i,e,s,this.layout.digit.font,this.layout.digit.pixel,this.color.txt)}return u(this.context),n}}(this);break;case"CHART.LINE":default:h=new q(this)}return h.name=t,this.childCharts[t]=h,h.init(e,s),h},this.onPaint=function(t){this.fastDrawBegin();for(const i in this.childCharts)void 0!==t?this.childCharts[i]===t&&this.childCharts[i].onPaint():this.childCharts[i].onPaint()},this.fastDrawBegin=function(){this.fastDraw||(this.fastBuffer=[],this.fastDraw=!0)},this.fastDrawEnd=function(){this.fastDraw=!1},this.setHideInfo=function(t){void 0!==t&&t!==this.linkInfo.hideInfo&&(this.linkInfo.hideInfo=t,this.onPaint())},this.setColor=function(t,i){this.color=O(t,w.standard),void 0===i&&(i=this);for(const e in i.childCharts)i.childCharts[e].color=this.color,void 0!==i.childCharts[e]&&this.setColor(t,i.childCharts[e]);this.onPaint()}};function J(){return(new Date).getTime()}function $(t,i){return Math.sqrt(t*t+i*i)}function Q(t,i){const e={name:"touch"};let s={left:0,top:0};return void 0!==i&&(s=i.getBoundingClientRect()),e.offsetX=t.pageX-s.left,e.offsetY=t.pageY-s.top,e}function tt(t){this.eventCanvas=t.canvas,this.eventPlatform=t.eventPlatform||"html5",this.scale=t.scale,"react"===this.eventPlatform||(this.eventSource=new function(t){this.father=t,this.eventCanvas=t.eventCanvas,this.bindEvent=function(){this.addHandler("mousemove",this.mousemove.bind(this)),this.addHandler("mouseout",this.mouseout.bind(this)),this.addHandler("mousewheel",this.mousewheel.bind(this)),this.addHandler("mouseup",this.mouseup.bind(this)),this.addHandler("mousedown",this.mousedown.bind(this)),this.addHandler("keyup",this.keyup.bind(this)),this.addHandler("keydown",this.keydown.bind(this)),this.addHandler("touchstart",this.touchstart.bind(this)),this.addHandler("touchend",this.touchend.bind(this)),this.addHandler("touchmove",this.touchmove.bind(this)),this.addHandler("click",this.click.bind(this))},this.clearEvent=function(){this.clearHandler("mousemove",this.mousemove.bind(this)),this.clearHandler("mouseout",this.mouseout.bind(this)),this.clearHandler("mousewheel",this.mousewheel.bind(this)),this.clearHandler("mouseup",this.mouseup.bind(this)),this.clearHandler("mousedown",this.mousedown.bind(this)),this.clearHandler("keyup",this.keyup.bind(this)),this.clearHandler("keydown",this.keydown.bind(this)),this.clearHandler("touchstart",this.touchstart.bind(this)),this.clearHandler("touchend",this.touchend.bind(this)),this.clearHandler("touchmove",this.touchmove.bind(this)),this.clearHandler("click",this.click.bind(this))},this.addHandler=function(t,i){this.eventCanvas.addEventListener?this.eventCanvas.addEventListener(t,i,!1):this.eventCanvas.attachEvent?this.eventCanvas.attachEvent("on"+t,i):this.eventCanvas["on"+t]=i},this.clearHandler=function(t,i){this.eventCanvas.removeEventListener?this.eventCanvas.removeEventListener(t,i,!1):this.eventCanvas.deattachEvent?this.eventCanvas.deattachEvent("on"+t,i):this.eventCanvas["on"+t]=null},this.getEventInfo=function(t){return{offsetX:t.offsetX,offsetY:t.offsetY}},this.mousemove=function(t){this.father.emitEvent("onMouseMove",this.getEventInfo(t))},this.mousein=function(t){this.father.emitEvent("onMouseIn",this.getEventInfo(t))},this.mouseout=function(t){this.father.emitEvent("onMouseOut",this.getEventInfo(t))},this.mousewheel=function(t){const i=this.getEventInfo(t);i.deltaY=t.deltaY,this.father.emitEvent("onMouseWheel",i)},this.mouseup=function(t){this.father.emitEvent("onMouseUp",this.getEventInfo(t))},this.mousedown=function(t){this.father.emitEvent("onMouseDown",this.getEventInfo(t))},this.keyup=function(t){const i=this.getEventInfo(t);i.keyCode=t.keyCode,this.father.emitEvent("onKeyUp",i)},this.keydown=function(t){const i=this.getEventInfo(t);i.keyCode=t.keyCode,this.father.emitEvent("onKeyDown",i)},this.click=function(t){this.father.emitEvent("onClick",this.getEventInfo(t))},this.touchstart=function(t){this.__timestamp=new Date;const i=t.touches?t.touches[0]:t;if(this.startX=i.pageX,this.startY=i.pageY,window.clearTimeout(this.longTapTimeout),t.touches.length>1){const i=t.touches[1],e=Math.abs(i.pageX-this.startX),s=Math.abs(i.pageY-this.startY);this.touchDistance=$(e,s),this.touchVector={x:i.pageX-this.startX,y:i.pageY-this.startY},this.startTime=J()}else this.startTime=J(),this.longTapTimeout=setTimeout(()=>{this.father.emitEvent("onLongPress",Q(i,t.srcElement))},600),this.previousTouchPoint&&Math.abs(this.startX-this.previousTouchPoint.startX)<10&&Math.abs(this.startY-this.previousTouchPoint.startY)<10&&Math.abs(this.startTime-this.previousTouchTime)<300&&this.father.emitEvent("onDBClick",Q(i,t.srcElement)),this.previousTouchTime=this.startTime,this.previousTouchPoint={startX:this.startX,startY:this.startY}},this.touchend=function(t){const i=t.changedTouches?t.changedTouches[0]:t;window.clearTimeout(this.longTapTimeout);const e=J();null!==this.moveX&&Math.abs(this.moveX-this.startX)>10||null!==this.moveY&&Math.abs(this.moveY-this.startY)>10?e-this.startTime<500&&this.father.emitEvent("onSwipe",Q(i,t.srcElement)):e-this.startTime<2e3&&(e-this.startTime<500&&this.father.emitEvent("onClick",Q(i,t.srcElement)),e-this.startTime>500&&this.father.emitEvent("onLongPress",Q(i,t.srcElement))),this.startX=this.startY=this.moveX=this.moveY=null,this.previousPinchScale=1,this.father.emitEvent("onMouseOut",Q(i,t.srcElement))},this.touchmove=function(t){if(new Date-this.__timestamp<150)return t;const i=J();if(t.touches.length>1){const e=$(Math.abs(t.touches[0].pageX-t.touches[1].pageX),Math.abs(t.touches[1].pageY-t.touches[1].pageY));if(this.touchDistance){const s=e/this.touchDistance,n=Q(t.touches?t.touches[0]:t,t.srcElement);n.scale=s-this.previousPinchScale,i-this.startTime>90&&(this.father.emitEvent("onPinch",n),this.startTime=J()),this.previousPinchScale=s}if(this.touchVector){const i={x:t.touches[1].pageX-t.touches[0].pageX,y:t.touches[1].pageY-t.touches[0].pageY},e=function(t,i){let e=function(t,i){return t.x*i.y-i.x*t.y}(t,i);e=e>0?-1:1;const s=$(t.x,t.y)*$(i.x,i.y);if(0===s)return 0;let n=(t.x*i.x+t.y*i.y)/s;return n>1&&(n=1),n<-1&&(n=-1),Math.acos(n)*e*180/Math.PI}(i,this.touchVector);this._emitEvent("onRotate",{angle:e}),this.touchVector.x=i.x,this.touchVector.y=i.y}}else{window.clearTimeout(this.longTapTimeout);const i=t.touches?t.touches[0]:t,e=null===this.moveX?0:i.pageX-this.moveX,s=null===this.moveY?0:i.pageY-this.moveY,n=Q(i,t.srcElement);n.deltaX=e,n.deltaY=s,this.father.emitEvent("onMouseMove",n),this.moveX=i.pageX,this.moveY=i.pageY}t.preventDefault()}}(this)),this.eventSource.bindEvent(),this.bindChart=function(t){this.firstChart=t,this.HotWin=void 0},this.clearEvent=function(){this.eventSource.clearEvent()},this.emitEvent=function(t,i){if("onMouseOut"===t||"onMouseMove"===t)return this.boardEvent(this.firstChart,t,i),void(this.HotWin=void 0);const e=this.getMousePos(i),s=[];for(const t in this.firstChart.childCharts)if(Object(n.r)(this.firstChart.childCharts[t].rectMain,e)){this.findEventPath(s,this.firstChart.childCharts[t],e);break}if(s.length<1)return;const o=Object(n.b)(i);for(let i=s.length-1;i>=0&&(void 0===s[i][t]||(o.mousePos={x:e.x,y:e.y},s[i][t](o),!o.break));i--);},this.boardEvent=function(t,i,e,s){const o=Object(n.b)(e),h=this.getMousePos(e);for(const e in t.childCharts)if(t.childCharts[e]!==s&&void 0!==t.childCharts[e][i]&&(o.mousePos={x:h.x,y:h.y},t.childCharts[e][i](o),o.break))break},this.findEventPath=function(t,i,e){if(t.push(i),void 0!==i.childCharts)for(const s in i.childCharts)Object(n.r)(i.childCharts[s].rectMain,e)&&this.findEventPath(t,i.childCharts[s],e)},this.getMousePos=function(t){return{x:t.offsetX*this.scale,y:t.offsetY*this.scale}}}var it=e(3);function et(){this.static={stktype:1,volunit:100,coinunit:100,decimal:2,before:1e3,stophigh:1100,stoplow:900},this.initData=function(t,i){this.formula=new it.a,this.clearData(),this.tradeTime=void 0===i?[{begin:930,end:1130},{begin:1300,end:1500}]:i,this.tradeDate=void 0===t?Object(n.h)():t},this.clearData=function(){this.InData=[],this.OutData=[]},this.setData=function(t,i,e){switch(void 0===e&&(e=[]),void 0===this.InData[t]&&(this.InData[t]={}),t){case"DAY5":e=Object(Y.a)(e,this.static.coinunit,this.tradeDate,this.tradeTime);break;case"NOW":case"ENOW":this.flushNowData(t,e);break;case"MIN":case"DAY":e=Object(Y.b)(e,this.tradeDate);break;case"INFO":this.static=Object(Y.o)(B.FIELD_INFO,e);break;case"CODE":this.static=Object(Y.o)(B.FIELD_CODE,e)}this.InData[t]={key:t,fields:i},this.InData[t].value=Object(n.a)(e)},this.flushTick=function(t,i){Object(Y.j)(this.InData.TICK)<1?t[i.vol]>0&&(this.InData.TICK={key:"TICK",fields:B.FIELD_TICK,value:[t[i.time],t[i.close],t[i.vol]]}):(this.InData.TICK.value[this.InData.TICK.value.length-1][B.FIELD_TICK.vol]<t[i.vol]||this.InData.TICK.value[this.InData.TICK.value.length-1][B.FIELD_TICK.close]!==t[i.close])&&this.InData.TICK.value.push([t[i.time],t[i.close],t[i.vol]])},this.flushMin=function(t,i){if(void 0===this.InData.MIN)this.InData.MIN={key:"MIN",fields:B.FIELD_MIN,value:[Object(Y.h)(t[i.time],this.tradeTime),t[i.open],t[i.high],t[i.low],t[i.close],t[i.vol],t[i.money]]};else{const e=Object(Y.h)(t[i.time],this.tradeTime),s=Object(Y.f)(this.InData.MIN,e);"old"===s.status?(this.InData.MIN.value[s.index][i.high]<t[i.close]&&(this.InData.MIN.value[s.index][i.high]=t[i.close]),this.InData.MIN.value[s.index][i.low]>t[i.close]&&(this.InData.MIN.value[s.index][i.low]=t[i.close]),this.InData.MIN.value[s.index][i.close]=t[i.close],this.InData.MIN.value[s.index][i.vol]=t[i.vol],this.InData.MIN.value[s.index][i.money]=t[i.money]):"new"===s.status&&this.InData.MIN.value.push([e,t[i.close],t[i.close],t[i.close],t[i.close],t[i.vol],t[i.money]])}},this.flushNowData=function(t,i){if(i.length<1)return;let e=B.FIELD_NOW;"ENOW"===t&&(e=B.FIELD_ENOW),Object(Y.c)(i,e)||(this.flushTick(i,e),this.flushMin(i,e))},this.getData=function(t,i){switch(t){case"DAY":this.OutData.DAY={key:t,fields:B.FIELD_DAY},this.OutData.DAY.value=this.mergeDay(this.InData.DAY,this.InData.NOW,i);break;case"WEEK":this.OutData.WEEK={key:t,fields:B.FIELD_DAY},this.OutData.WEEK.value=this.mergeWeek(this.InData.DAY,this.InData.NOW,i);break;case"MON":this.OutData.MON={key:t,fields:B.FIELD_DAY},this.OutData.MON.value=this.mergeMon(this.InData.DAY,this.InData.NOW,i);break;case"DAY5":this.OutData.DAY5={key:t,fields:B.FIELD_DAY5},this.OutData.DAY5.value=this.mergeDay5(this.InData.DAY5,this.InData.MIN);break;case"M5":case"M15":case"M30":case"M60":this.OutData[t]={key:t,fields:B.FIELD_DAY},this.OutData[t].value=this.makeMinute(t,this.InData[t],this.InData.MIN,i);break;case"MIN":this.OutData[t]={key:t,fields:B.FIELD_MIN},this.OutData[t].value=this.updateMinute(this.InData[t])}return this.OutData[t]?this.OutData[t]:this.InData[t]},this.updateMinute=function(t){let i,e=Object(n.a)(t.value);for(let t=0;t<e.length;t++)0===this.static.stktype&&(0===t?i=e[t][B.FIELD_MIN.vol]*e[t][B.FIELD_MIN.close]/this.static.coinunit:i+=(e[t][B.FIELD_MIN.vol]-e[t-1][B.FIELD_MIN.vol])*e[t][B.FIELD_MIN.close]/this.static.coinunit,e[t][B.FIELD_MIN.allmoney]=i);return e},this.mergeDay=function(t,i,e){let s=Object(n.a)(t.value);if(void 0!==i&&!Object(Y.c)(i.value,i.fields)){const e=Object(Y.e)(t,Object(n.h)(i.value[i.fields.time]));e.finded?s[e.index]=[Object(n.h)(i.value[i.fields.time]),i.value[i.fields.open],i.value[i.fields.high],i.value[i.fields.low],i.value[i.fields.close],i.value[i.fields.vol],i.value[i.fields.money]]:s.push([Object(n.h)(i.value[i.fields.time]),i.value[i.fields.open],i.value[i.fields.high],i.value[i.fields.low],i.value[i.fields.close],i.value[i.fields.vol],i.value[i.fields.money]])}return this.InData.RIGHT&&"none"!==e&&(s=Object(Y.m)(s,this.static.coinunit,this.InData.RIGHT.value,e,0,s.length-1)),s},this.mergeWeek=function(t,i,e){const s=this.mergeDay(t,i,e);return Object(Y.l)(s)},this.mergeMon=function(t,i,e){const s=this.mergeDay(t,i,e);return Object(Y.k)(s)},this.mergeDay5=function(t,i){let e=[];if(void 0!==t&&!Object(n.s)(t.value)&&(e=Object(n.a)(t.value),Object(n.h)(t.value[t.value.length-1][t.fields.time])===this.tradeDate))return e;if(void 0===i||Object(n.s)(i.value))return e;const s=4*Object(Y.i)(this.tradeTime);let o;for(let t=0;t<i.value.length;t++)0===this.static.stktype?0===t?o=i.value[t][i.fields.vol]*i.value[t][i.fields.close]/this.static.coinunit:o+=(i.value[t][i.fields.vol]-i.value[t-1][i.fields.vol])*i.value[t][i.fields.close]/this.static.coinunit:o=i.value[t][i.fields.money],e.push([Object(Y.g)(i.value[t][i.fields.idx],this.tradeTime,this.tradeDate),i.value[t][i.fields.close],0===t?i.value[t][i.fields.vol]:i.value[t][i.fields.vol]-i.value[t-1][i.fields.vol],s+i.value[t][i.fields.idx],i.value[t][i.fields.vol],o]);return e},this.makeMinute=function(t,i,e,s){let o=[];if(void 0!==i&&!Object(n.s)(i.value)&&(o=Object(n.a)(i.value),o=Object(Y.n)(o,this.static.coinunit,this.InData.RIGHT.value,s,0,o.length-1),Object(n.h)(i.value[i.value.length-1][i.fields.time])===this.tradeDate))return o;if(void 0!==e&&!Object(n.s)(e.value)){let i=5;"M15"===t&&(i=15),"M30"===t&&(i=30),"M60"===t&&(i=60),o=this.mergeNowMinToMin(o,e,i)}return o},this.mergeNowMinToMin=function(t,i,e){const s=[];let o=0,h=0,a=!1,l=4;for(let c=0;c<i.value.length;c++){const r=i.value[c][i.fields.idx];r<0||(r>l?(a&&(s[i.fields.vol]=i.value[c][i.fields.vol]-o,s[i.fields.money]=i.value[c][i.fields.money]-h,o=i.value[c][i.fields.vol],h=i.value[c][i.fields.money],s[i.fields.time]=Object(Y.g)(l,this.tradeTime,this.tradeDate),t.push(Object(n.a)(s))),l=(Math.floor(r/e)+1)*e-1,s[i.fields.open]=i.value[c][i.fields.open],s[i.fields.high]=i.value[c][i.fields.high],s[i.fields.low]=i.value[c][i.fields.low],s[i.fields.close]=i.value[c][i.fields.close],a=!0):a?(s[i.fields.high]=s[i.fields.high]>i.value[c][i.fields.high]?s[i.fields.high]:i.value[c][i.fields.high],s[i.fields.low]=s[i.fields.low]<i.value[c][i.fields.low]||0===i.value[c][i.fields.low]?s[i.fields.low]:i.value[c][i.fields.low],s[i.fields.close]=i.value[c][i.fields.close]):(s[i.fields.open]=i.value[c][i.fields.open],s[i.fields.high]=i.value[c][i.fields.high],s[i.fields.low]=i.value[c][i.fields.low],s[i.fields.close]=i.value[c][i.fields.close],a=!0))}return a&&(s[i.fields.vol]=i.value[i.value.length-1][i.fields.vol]-o,s[i.fields.money]=i.value[i.value.length-1][i.fields.money]-h,s[i.fields.time]=Object(Y.g)(l,this.tradeTime,this.tradeDate),t.push(Object(n.a)(s))),t},this.makeLineData=function(t,i,e){const s=this.formula.runSingleStock(t,e);return void 0===this.OutData[i]?this.OutData[i]={outkey:i,fields:B.FIELD_ILINE,value:s}:this.OutData[i].value=s,this.OutData[i]}}e.d(i,"DEF_CHART",function(){return st}),e.d(i,"DEF_DATA",function(){return nt}),e.d(i,"createSingleChart",function(){return ot}),e.d(i,"createMulChart",function(){return ht});const st=s,nt=B;function ot(t){C(t);const i=new Z(t.context),e=new tt(t),s=new et;return i.initChart(s,e),i}function ht(t){C(t);const i=new tt(t),e={};for(const s in t.charts){const n=new Z(t.context),o=new et;n.initChart(o,i),e[s]=n}return e}}])});
//# sourceMappingURL=ClChart.js.map